{"ast":null,"code":"(function (a, b) {\n  if ('function' == typeof define && define.amd) define(['exports', 'react', 'prop-types', 'whatkey', './styled-elements'], b);else if ('undefined' != typeof exports) b(exports, require('react'), require('prop-types'), require('whatkey'), require('./styled-elements'));else {\n    var c = {\n      exports: {}\n    };\n    b(c.exports, a.React, a.propTypes, a.whatkey, a.styledElements), a.index = c.exports;\n  }\n})(this, function (a, b, c, d, e) {\n  'use strict';\n\n  function f(a) {\n    return a && a.__esModule ? a : {\n      default: a\n    };\n  }\n  function g(a, b) {\n    if (!(a instanceof b)) throw new TypeError('Cannot call a class as a function');\n  }\n  function h(a, b) {\n    if (!a) throw new ReferenceError('this hasn\\'t been initialised - super() hasn\\'t been called');\n    return b && ('object' == typeof b || 'function' == typeof b) ? b : a;\n  }\n  function i(a, b) {\n    if ('function' != typeof b && null !== b) throw new TypeError('Super expression must either be null or a function, not ' + typeof b);\n    a.prototype = Object.create(b && b.prototype, {\n      constructor: {\n        value: a,\n        enumerable: !1,\n        writable: !0,\n        configurable: !0\n      }\n    }), b && (Object.setPrototypeOf ? Object.setPrototypeOf(a, b) : a.__proto__ = b);\n  }\n  Object.defineProperty(a, '__esModule', {\n    value: !0\n  });\n  var j,\n    k,\n    l = f(b),\n    m = f(c),\n    n = f(d),\n    o = Object.assign || function (a) {\n      for (var b, c = 1; c < arguments.length; c++) for (var d in b = arguments[c], b) Object.prototype.hasOwnProperty.call(b, d) && (a[d] = b[d]);\n      return a;\n    },\n    p = function () {\n      function a(a, b) {\n        for (var c, d = 0; d < b.length; d++) c = b[d], c.enumerable = c.enumerable || !1, c.configurable = !0, 'value' in c && (c.writable = !0), Object.defineProperty(a, c.key, c);\n      }\n      return function (b, c, d) {\n        return c && a(b.prototype, c), d && a(b, d), b;\n      };\n    }(),\n    q = (k = j = function (a) {\n      function b() {\n        var a, c, f, e;\n        g(this, b);\n        for (var i = arguments.length, j = Array(i), k = 0; k < i; k++) j[k] = arguments[k];\n        return e = (c = (f = h(this, (a = b.__proto__ || Object.getPrototypeOf(b)).call.apply(a, [this].concat(j))), f), f.state = {\n          summary: [],\n          promptPrefix: '',\n          history: [],\n          historyCounter: 0,\n          input: [],\n          keyInputs: [],\n          canScroll: !0\n        }, f.componentWillMount = function () {\n          var a = f.context.instances.find(function (a) {\n            return a.index === f.props.id;\n          });\n          a && f.setState(a.oldData);\n        }, f.componentDidMount = function () {\n          f.focusInput();\n          var a = f.context.instances.find(function (a) {\n            return a.index === f.props.id;\n          });\n          f.unregister = f.props.register(f), a && 0 !== Object.keys(a.oldData).length || f.handleChange({\n            target: {\n              value: 'show'\n            },\n            key: 'Enter',\n            dontShowCommand: !0\n          });\n        }, f.componentDidUpdate = function () {\n          null !== f.inputWrapper && f.inputWrapper.scrollIntoView(!1);\n        }, f.setScrollPosition = function (a) {\n          setTimeout(function () {\n            null !== f.contentWrapper && (f.contentWrapper.scrollTop = a);\n          }, 50);\n        }, f.focusInput = function () {\n          null !== f.com && f.com.focus();\n        }, f.handleChange = function (a) {\n          f.props.handleChange(f, a);\n        }, f.handleKeyPress = function (a) {\n          f.props.handlerKeyPress(f, a, f.com);\n        }, f.handleOuterKeypress = function (a) {\n          var b = (0, n.default)(a).key;\n          0 > d.unprintableKeys.indexOf(b) ? document.activeElement !== f.com && (f.com.focus(), f.com.value += (0, n.default)(a).char) : -1 < ['up', 'down', 'left', 'right', 'enter'].indexOf(b) && f.com.focus();\n        }, c), h(f, e);\n      }\n      return i(b, a), p(b, [{\n        key: 'componentWillUnmount',\n        value: function () {\n          this.unregister(this.state);\n        }\n      }, {\n        key: 'render',\n        value: function () {\n          var a = this,\n            b = this.props.id,\n            c = this.context,\n            d = c.symbol,\n            f = c.maximise,\n            g = c.activeTab,\n            h = c.barShowing,\n            i = c.tabsShowing;\n          if (b !== g) return null;\n          var j = this.state.summary.map(function (a, b) {\n              return 'string' == typeof a && 0 === a.length ? l.default.createElement(e.OutputLine, {\n                key: b\n              }, '\\xA0') : l.default.createElement(e.PreOutputLine, {\n                key: b\n              }, a);\n            }),\n            k = 30;\n          return h || (k -= 30), i && (k += 30), l.default.createElement(e.ContainerMain, {\n            style: o({}, f ? {\n              maxWidth: '100%',\n              maxHeight: 'calc(100% - ' + k + 'px)'\n            } : {}, this.state.canScroll ? {\n              overflowY: 'auto'\n            } : {\n              overflowY: 'hidden'\n            }),\n            tabIndex: '0',\n            onKeyUp: this.handleOuterKeypress,\n            innerRef: function (b) {\n              return a.contentWrapper = b;\n            }\n          }, l.default.createElement(e.Holder, null, l.default.createElement(e.ContainerContent, null, l.default.createElement(e.InputArea, null, j, l.default.createElement(e.Input, {\n            innerRef: function (b) {\n              return a.inputWrapper = b;\n            }\n          }, l.default.createElement(e.Prompt, null, this.state.promptPrefix + d), l.default.createElement(e.MainInput, {\n            type: 'text',\n            tabIndex: '-1',\n            innerRef: function (b) {\n              return a.com = b;\n            },\n            onKeyPress: this.handleChange,\n            onKeyDown: this.handleKeyPress\n          }))))));\n        }\n      }]), b;\n    }(b.Component), j.displayName = 'Content', j.propTypes = {\n      id: m.default.string,\n      oldData: m.default.object,\n      register: m.default.func,\n      handleChange: m.default.func,\n      handlerKeyPress: m.default.func.isRequired\n    }, j.defaultProps = {\n      oldData: {}\n    }, j.contextTypes = {\n      symbol: m.default.string,\n      maximise: m.default.bool,\n      instances: m.default.array,\n      activeTab: m.default.string,\n      barShowing: m.default.bool,\n      tabsShowing: m.default.bool\n    }, k);\n  a.default = q;\n});","map":{"version":3,"mappings":"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","names":["state","summary","promptPrefix","history","historyCounter","input","keyInputs","canScroll","componentWillMount","a","f","context","instances","find","index","props","id","setState","oldData","componentDidMount","focusInput","unregister","register","keys","length","handleChange","target","value","key","dontShowCommand","componentDidUpdate","inputWrapper","scrollIntoView","setScrollPosition","setTimeout","contentWrapper","scrollTop","com","focus","handleKeyPress","handlerKeyPress","handleOuterKeypress","b","indexOf","document","activeElement","char","c","d","symbol","maximise","g","activeTab","h","barShowing","i","tabsShowing","j","map","l","k","style","maxWidth","maxHeight","overflowY","tabIndex","onKeyUp","innerRef","type","onKeyPress","onKeyDown","displayName","propTypes","m","string","object","func","isRequired","defaultProps","contextTypes","bool","array"],"sources":["../../../../src/js/components/Content/index.js"],"sourcesContent":["import React, {Component} from 'react'; // eslint-disable-line\nimport PropTypes from 'prop-types';\nimport whatkey, { unprintableKeys } from 'whatkey';\nimport {\n  ContainerMain, ContainerContent, Holder,\n  Input, InputArea, MainInput,\n  OutputLine, PreOutputLine, Prompt,\n} from './styled-elements';\n\nclass Content extends Component {\n  static displayName = 'Content';\n\n  static propTypes = {\n    id: PropTypes.string,\n    oldData: PropTypes.object, // eslint-disable-line\n    register: PropTypes.func,\n    handleChange: PropTypes.func,\n    handlerKeyPress: PropTypes.func.isRequired,\n  };\n\n  static defaultProps = {\n    oldData: {},\n  };\n\n  static contextTypes = {\n    symbol: PropTypes.string,\n    maximise: PropTypes.bool,\n    instances: PropTypes.array,\n    activeTab: PropTypes.string,\n    barShowing: PropTypes.bool,\n    tabsShowing: PropTypes.bool,\n  };\n\n  state = {\n    summary: [],\n    promptPrefix: '',\n    history: [],\n    historyCounter: 0,\n    input: [],\n    keyInputs: [],\n    canScroll: true,\n  };\n\n  componentWillMount = () => {\n    const data = this.context.instances.find(i => i.index === this.props.id);\n    if (data) {\n      this.setState(data.oldData);\n    }\n  };\n\n  componentDidMount = () => {\n    this.focusInput();\n    const data = this.context.instances.find(i => i.index === this.props.id);\n    this.unregister = this.props.register(this);\n    if (!data || Object.keys(data.oldData).length === 0) {\n      this.handleChange({ target: { value: 'show' }, key: 'Enter', dontShowCommand: true });\n    }\n  };\n\n  // Adjust scrolling\n  componentDidUpdate = () => {\n    if (this.inputWrapper !== null) {\n      this.inputWrapper.scrollIntoView(false);\n    }\n  };\n\n  componentWillUnmount() {\n    this.unregister(this.state);\n  }\n\n  setScrollPosition = (pos) => {\n    setTimeout(() => {\n      if (this.contentWrapper !== null) {\n        this.contentWrapper.scrollTop = pos;\n      }\n    }, 50);\n  };\n\n  focusInput = () => {\n    if (this.com !== null) {\n      this.com.focus();\n    }\n  };\n\n  handleChange = (e) => {\n    this.props.handleChange(this, e);\n  }\n\n  handleKeyPress = (e) => {\n    this.props.handlerKeyPress(this, e, this.com);\n  }\n\n  handleOuterKeypress = (e) => {\n    const key = whatkey(e).key;\n    const actionKeys = ['up', 'down', 'left', 'right', 'enter'];\n    if (unprintableKeys.indexOf(key) < 0) {\n      if (document.activeElement !== this.com) {\n        this.com.focus();\n        this.com.value += whatkey(e).char;\n      }\n    } else if (actionKeys.indexOf(key) > -1) {\n      this.com.focus();\n    }\n  }\n\n  render() {\n    const { id } = this.props;\n    const { symbol, maximise, activeTab, barShowing, tabsShowing } = this.context;\n\n    if (id !== activeTab) {\n      return null;\n    }\n\n    const output = this.state.summary.map((content, i) => {\n      if (typeof content === 'string' && content.length === 0) {\n        return <OutputLine key={i}>&nbsp;</OutputLine>;\n      }\n      return <PreOutputLine key={i}>{content}</PreOutputLine>;\n    });\n\n    let toSubtract = 30;\n    if (!barShowing) {\n      toSubtract -= 30;\n    }\n    if (tabsShowing) {\n      toSubtract += 30;\n    }\n\n    return (\n      <ContainerMain\n        style={{\n          ...(maximise\n            ? { maxWidth: '100%', maxHeight: `calc(100% - ${toSubtract}px)` }\n            : {}),\n          ...(this.state.canScroll\n            ? { overflowY: 'auto' }\n            : { overflowY: 'hidden' }),\n        }}\n        tabIndex=\"0\"\n        onKeyUp={this.handleOuterKeypress}\n        innerRef={ctw => (this.contentWrapper = ctw)}\n      >\n        <Holder>\n          <ContainerContent>\n            <InputArea>\n              {output}\n              <Input\n                innerRef={elm => (this.inputWrapper = elm)}\n              >\n                <Prompt>\n                  {this.state.promptPrefix + symbol}\n                </Prompt>\n                <MainInput\n                  type=\"text\"\n                  tabIndex=\"-1\"\n                  innerRef={com => (this.com = com)}\n                  onKeyPress={this.handleChange}\n                  onKeyDown={this.handleKeyPress}\n                />\n              </Input>\n            </InputArea>\n          </ContainerContent>\n        </Holder>\n      </ContainerMain>\n    );\n  }\n}\n\nexport default Content;\n"]},"metadata":{},"sourceType":"script"}