{"ast":null,"code":"import _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _inheritsLoose from \"@babel/runtime/helpers/esm/inheritsLoose\";\nimport _isNil from \"lodash/isNil\";\nimport _isFunction from \"lodash/isFunction\";\nimport _isNumber from \"lodash/isNumber\";\nimport _isString from \"lodash/isString\";\nimport _omit from \"lodash/omit\";\nimport _get from \"lodash/get\";\nimport _isEmpty from \"lodash/isEmpty\";\nimport _isUndefined from \"lodash/isUndefined\";\nimport _isArray from \"lodash/isArray\";\nimport * as React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport List from 'react-virtualized/dist/commonjs/List';\nimport AutoSizer from 'react-virtualized/dist/commonjs/AutoSizer';\nimport { CellMeasurerCache, CellMeasurer } from 'react-virtualized/dist/commonjs/CellMeasurer';\nimport { polyfill } from 'react-lifecycles-compat';\nimport shallowEqual from '../utils/shallowEqual';\nimport TreeNode from './TreeNode';\nimport { defaultProps, prefix, defaultClassPrefix, getUnhandledProps, createChainedFunction, mergeRefs } from '../utils';\nimport { flattenTree, getExpandWhenSearching, getNodeParents, shouldShowNodeByExpanded, treeDeprecatedWarning, hasVisibleChildren, compareArray, getExpandAll, getExpandItemValues, getExpandState, getDragNodeKeys, calDropNodePosition, createUpdateTreeDataFunction } from '../utils/treeUtils';\nimport { PickerToggle, getToggleWrapperClassName, onMenuKeyDown, MenuWrapper, SearchBar, PickerToggleTrigger, createConcatChildrenFunction, shouldDisplay } from '../Picker';\nimport { TREE_NODE_DROP_POSITION } from '../constants';\nimport { listPickerPropTypes, listPickerDefaultProps } from '../Picker/propTypes'; // default value for virtualized\n\nvar defaultHeight = 360;\nvar defaultWidth = 200;\nvar TreePicker = /*#__PURE__*/\nfunction (_React$Component) {\n  _inheritsLoose(TreePicker, _React$Component);\n  function TreePicker(props) {\n    var _this;\n    _this = _React$Component.call(this, props) || this;\n    _this.menuRef = void 0;\n    _this.treeViewRef = void 0;\n    _this.positionRef = void 0;\n    _this.listRef = void 0;\n    _this.triggerRef = void 0;\n    _this.toggleRef = void 0;\n    _this.getFocusableMenuItems = function () {\n      var filterData = _this.state.filterData;\n      var _this$props = _this.props,\n        childrenKey = _this$props.childrenKey,\n        _this$props$disabledI = _this$props.disabledItemValues,\n        disabledItemValues = _this$props$disabledI === void 0 ? [] : _this$props$disabledI,\n        valueKey = _this$props.valueKey;\n      var items = [];\n      var loop = function loop(nodes) {\n        nodes.forEach(function (node) {\n          var nodeData = _extends({}, node, {}, _this.nodes[node.refKey]);\n          var disabled = disabledItemValues.some(function (disabledItem) {\n            return shallowEqual(disabledItem, node[valueKey]);\n          });\n          if (!disabled) {\n            items.push(node);\n          }\n          if (node[childrenKey] && getExpandState(nodeData, _this.props)) {\n            loop(node[childrenKey]);\n          }\n        });\n      };\n      loop(filterData);\n      return items;\n    };\n    _this.getElementByDataKey = function (dataKey) {\n      var ele = _this.nodeRefs[dataKey];\n      if (ele instanceof Element) {\n        return ele.querySelector(\".\" + _this.addTreePrefix('node-label'));\n      }\n      return null;\n    };\n    _this.nodes = {};\n    _this.node = null;\n    _this.cache = new CellMeasurerCache({\n      fixedWidth: true,\n      minHeight: 20\n    });\n    _this.nodeRefs = {};\n    _this.dragNode = null;\n    _this.bindNodeRefs = function (refKey, ref) {\n      _this.nodeRefs[refKey] = ref;\n    };\n    _this.getPositionInstance = function () {\n      return _this.positionRef.current;\n    };\n    _this.getToggleInstance = function () {\n      return _this.toggleRef.current;\n    };\n    _this.addPrefix = function (name) {\n      return prefix(_this.props.classPrefix)(name);\n    };\n    _this.addTreePrefix = function (name) {\n      return prefix(defaultClassPrefix('tree'))(name);\n    };\n    _this.selectActiveItem = function (event) {\n      var _this$getActiveItem = _this.getActiveItem(),\n        nodeData = _this$getActiveItem.nodeData;\n      _this.handleSelect(nodeData, event);\n    };\n    _this.focusNextItem = function () {\n      var _node$focus;\n      var _this$getItemsAndActi = _this.getItemsAndActiveIndex(),\n        items = _this$getItemsAndActi.items,\n        activeIndex = _this$getItemsAndActi.activeIndex;\n      if (items.length === 0) {\n        return;\n      }\n      var nextIndex = activeIndex === items.length - 1 ? 0 : activeIndex + 1;\n      var node = _this.getElementByDataKey(items[nextIndex].refKey);\n      node === null || node === void 0 ? void 0 : (_node$focus = node.focus) === null || _node$focus === void 0 ? void 0 : _node$focus.call(node);\n    };\n    _this.focusPreviousItem = function () {\n      var _node$focus2;\n      var _this$getItemsAndActi2 = _this.getItemsAndActiveIndex(),\n        items = _this$getItemsAndActi2.items,\n        activeIndex = _this$getItemsAndActi2.activeIndex;\n      if (items.length === 0) {\n        return;\n      }\n      var prevIndex = activeIndex === 0 ? items.length - 1 : activeIndex - 1;\n      prevIndex = prevIndex >= 0 ? prevIndex : 0;\n      var node = _this.getElementByDataKey(items[prevIndex].refKey);\n      node === null || node === void 0 ? void 0 : (_node$focus2 = node.focus) === null || _node$focus2 === void 0 ? void 0 : _node$focus2.call(node);\n    };\n    _this.handleCloseDropdown = function () {\n      var _this$triggerRef$curr, _this$triggerRef$curr2;\n      (_this$triggerRef$curr = _this.triggerRef.current) === null || _this$triggerRef$curr === void 0 ? void 0 : (_this$triggerRef$curr2 = _this$triggerRef$curr.hide) === null || _this$triggerRef$curr2 === void 0 ? void 0 : _this$triggerRef$curr2.call(_this$triggerRef$curr);\n    };\n    _this.handleOpenDropdown = function () {\n      var _this$triggerRef$curr3, _this$triggerRef$curr4;\n      (_this$triggerRef$curr3 = _this.triggerRef.current) === null || _this$triggerRef$curr3 === void 0 ? void 0 : (_this$triggerRef$curr4 = _this$triggerRef$curr3.show) === null || _this$triggerRef$curr4 === void 0 ? void 0 : _this$triggerRef$curr4.call(_this$triggerRef$curr3);\n    };\n    _this.open = function () {\n      var _this$handleOpenDropd, _this2;\n      (_this$handleOpenDropd = (_this2 = _this).handleOpenDropdown) === null || _this$handleOpenDropd === void 0 ? void 0 : _this$handleOpenDropd.call(_this2);\n    };\n    _this.close = function () {\n      var _this$handleCloseDrop, _this3;\n      (_this$handleCloseDrop = (_this3 = _this).handleCloseDropdown) === null || _this$handleCloseDrop === void 0 ? void 0 : _this$handleCloseDrop.call(_this3);\n    };\n    _this.handleToggleDropdown = function () {\n      var active = _this.state.active;\n      if (active) {\n        _this.handleCloseDropdown();\n        return;\n      }\n      _this.handleOpenDropdown();\n    };\n    _this.handleToggle = function (nodeData) {\n      var _this$props2 = _this.props,\n        valueKey = _this$props2.valueKey,\n        childrenKey = _this$props2.childrenKey,\n        onExpand = _this$props2.onExpand,\n        expandItemValues = _this$props2.expandItemValues;\n      var nextExpandItemValues = _this.toggleExpand(nodeData, !nodeData.expand);\n      if (_isUndefined(expandItemValues)) {\n        _this.unserializeLists('expand', nextExpandItemValues);\n        _this.setState({\n          expandItemValues: nextExpandItemValues\n        });\n      }\n      onExpand === null || onExpand === void 0 ? void 0 : onExpand(nextExpandItemValues, nodeData, createConcatChildrenFunction(nodeData, nodeData[valueKey], {\n        valueKey: valueKey,\n        childrenKey: childrenKey\n      }));\n    };\n    _this.handleSelect = function (nodeData, event) {\n      var _this$toggleRef$curre;\n      var _this$props3 = _this.props,\n        valueKey = _this$props3.valueKey,\n        onChange = _this$props3.onChange,\n        onSelect = _this$props3.onSelect,\n        value = _this$props3.value;\n      _this.node = nodeData;\n      if (_isUndefined(value)) {\n        _this.setState({\n          activeNode: nodeData,\n          selectedValue: nodeData[valueKey]\n        });\n      }\n      onChange === null || onChange === void 0 ? void 0 : onChange(nodeData[valueKey], event);\n      onSelect === null || onSelect === void 0 ? void 0 : onSelect(nodeData, nodeData[valueKey], event);\n      _this.handleCloseDropdown();\n      (_this$toggleRef$curre = _this.toggleRef.current) === null || _this$toggleRef$curre === void 0 ? void 0 : _this$toggleRef$curre.onFocus();\n    };\n    _this.handleKeyDown = function (event) {\n      onMenuKeyDown(event, {\n        down: _this.focusNextItem,\n        up: _this.focusPreviousItem,\n        enter: _this.selectActiveItem,\n        del: _this.handleClean\n      });\n    };\n    _this.handleToggleKeyDown = function (event) {\n      var _this$state = _this.state,\n        activeNode = _this$state.activeNode,\n        active = _this$state.active; // enter\n\n      if ((!activeNode || !active) && event.keyCode === 13) {\n        _this.handleToggleDropdown();\n      } // delete\n\n      if (event.keyCode === 8) {\n        _this.handleClean(event);\n      }\n      if (!_this.treeViewRef.current) {\n        return;\n      }\n      if (event.target instanceof HTMLElement) {\n        var className = event.target.className;\n        if (className.includes(_this.addPrefix('toggle')) || className.includes(_this.addPrefix('toggle-custom')) || className.includes(_this.addPrefix('search-bar-input'))) {\n          onMenuKeyDown(event, {\n            down: _this.focusNextItem\n          });\n        }\n      }\n    };\n    _this.handleSearch = function (value, event) {\n      var filterData = _this.state.filterData;\n      var _this$props4 = _this.props,\n        onSearch = _this$props4.onSearch,\n        searchKeyword = _this$props4.searchKeyword;\n      if (_isUndefined(searchKeyword)) {\n        _this.setState({\n          searchKeyword: value,\n          filterData: _this.getFilterData(filterData, value)\n        });\n      }\n      onSearch === null || onSearch === void 0 ? void 0 : onSearch(value, event);\n    };\n    _this.handleClean = function (event) {\n      var _this$props$onChange, _this$props5;\n      _this.setState({\n        activeNode: null,\n        selectedValue: null\n      });\n      _this.node = null;\n      (_this$props$onChange = (_this$props5 = _this.props).onChange) === null || _this$props$onChange === void 0 ? void 0 : _this$props$onChange.call(_this$props5, null, event);\n    };\n    _this.handleOnOpen = function () {\n      var _this$props$onOpen, _this$props6;\n      var activeNode = _this.state.activeNode;\n      if (activeNode) {\n        var _node$focus3;\n        var node = _this.getElementByDataKey(activeNode.refKey);\n        node === null || node === void 0 ? void 0 : (_node$focus3 = node.focus) === null || _node$focus3 === void 0 ? void 0 : _node$focus3.call(node);\n      }\n      (_this$props$onOpen = (_this$props6 = _this.props).onOpen) === null || _this$props$onOpen === void 0 ? void 0 : _this$props$onOpen.call(_this$props6);\n      _this.setState({\n        active: true\n      });\n    };\n    _this.handleOnClose = function () {\n      var filterData = _this.state.filterData;\n      var _this$props7 = _this.props,\n        searchKeyword = _this$props7.searchKeyword,\n        onClose = _this$props7.onClose;\n      if (_isUndefined(searchKeyword)) {\n        _this.setState({\n          searchKeyword: '',\n          filterData: _this.getFilterData(filterData, '')\n        });\n      }\n      onClose === null || onClose === void 0 ? void 0 : onClose();\n      _this.setState({\n        active: false\n      });\n    };\n    _this.handleDragStart = function (nodeData, event) {\n      var _this$props8 = _this.props,\n        valueKey = _this$props8.valueKey,\n        childrenKey = _this$props8.childrenKey,\n        onDragStart = _this$props8.onDragStart,\n        draggable = _this$props8.draggable;\n      if (draggable) {\n        _this.setState({\n          dragging: true,\n          dragNodeKeys: getDragNodeKeys(nodeData, childrenKey, valueKey)\n        });\n        _this.dragNode = _this.nodes[nodeData.refKey];\n        onDragStart === null || onDragStart === void 0 ? void 0 : onDragStart(nodeData, event);\n      }\n    };\n    _this.handleDragEnter = function (nodeData, event) {\n      var _this$state2 = _this.state,\n        dragging = _this$state2.dragging,\n        dragNodeKeys = _this$state2.dragNodeKeys;\n      var _this$props9 = _this.props,\n        valueKey = _this$props9.valueKey,\n        onDragEnter = _this$props9.onDragEnter;\n      if (dragNodeKeys.some(function (d) {\n        return shallowEqual(d, nodeData[valueKey]);\n      })) {\n        return;\n      }\n      if (dragging && _this.dragNode) {\n        var dropNodePosition = calDropNodePosition(event, _this.nodeRefs[nodeData.refKey]);\n        _this.setState({\n          dragOverNodeKey: nodeData[valueKey],\n          dropNodePosition: dropNodePosition\n        });\n      }\n      onDragEnter === null || onDragEnter === void 0 ? void 0 : onDragEnter(nodeData, event);\n    };\n    _this.handleDragOver = function (nodeData, event) {\n      var _this$state3 = _this.state,\n        dragNodeKeys = _this$state3.dragNodeKeys,\n        dragOverNodeKey = _this$state3.dragOverNodeKey,\n        dropNodePosition = _this$state3.dropNodePosition;\n      var _this$props10 = _this.props,\n        valueKey = _this$props10.valueKey,\n        onDragOver = _this$props10.onDragOver;\n      if (dragNodeKeys.some(function (d) {\n        return shallowEqual(d, nodeData[valueKey]);\n      })) {\n        return;\n      }\n      if (_this.dragNode && shallowEqual(nodeData[valueKey], dragOverNodeKey)) {\n        var lastDropNodePosition = calDropNodePosition(event, _this.nodeRefs[nodeData.refKey]);\n        if (lastDropNodePosition === dropNodePosition) return;\n        _this.setState({\n          dropNodePosition: lastDropNodePosition\n        });\n      }\n      onDragOver === null || onDragOver === void 0 ? void 0 : onDragOver(nodeData, event);\n    };\n    _this.handleDragLeave = function (nodeData, event) {\n      var onDragLeave = _this.props.onDragLeave;\n      onDragLeave === null || onDragLeave === void 0 ? void 0 : onDragLeave(nodeData, event);\n    };\n    _this.handleDragEnd = function (nodeData, event) {\n      var onDragEnd = _this.props.onDragEnd;\n      _this.setState({\n        dragging: false,\n        dragNodeKeys: [],\n        dragOverNodeKey: null\n      });\n      onDragEnd === null || onDragEnd === void 0 ? void 0 : onDragEnd(nodeData, event);\n    };\n    _this.handleDrop = function (nodeData, event) {\n      var dragNodeKeys = _this.state.dragNodeKeys;\n      var _this$props11 = _this.props,\n        valueKey = _this$props11.valueKey,\n        onDrop = _this$props11.onDrop;\n      if (dragNodeKeys.some(function (d) {\n        return shallowEqual(d, nodeData[valueKey]);\n      })) {\n        console.error('Cannot drag a node to itself and its children');\n      } else {\n        var dropData = _this.getDropData(nodeData);\n        onDrop === null || onDrop === void 0 ? void 0 : onDrop(dropData, event);\n      }\n      _this.setState({\n        dragging: false,\n        dragNodeKeys: [],\n        dragOverNodeKey: null,\n        dropNodePosition: null\n      });\n      _this.dragNode = null;\n    };\n    _this.measureRowRenderer = function (nodes) {\n      return function (_ref) {\n        var key = _ref.key,\n          index = _ref.index,\n          style = _ref.style,\n          parent = _ref.parent;\n        var node = nodes[index];\n        return React.createElement(CellMeasurer, {\n          cache: _this.cache,\n          columnIndex: 0,\n          key: key,\n          rowIndex: index,\n          parent: parent\n        }, function () {\n          return _this.renderVirtualNode(node, {\n            key: key,\n            style: style\n          });\n        });\n      };\n    };\n    var _value = props.value,\n      data = props.data,\n      _valueKey = props.valueKey,\n      _props$searchKeyword = props.searchKeyword,\n      _searchKeyword = _props$searchKeyword === void 0 ? '' : _props$searchKeyword;\n    var nextData = [].concat(data);\n    var _nextExpandItemValues = getExpandItemValues(props);\n    _this.flattenNodes(nextData);\n    _this.unserializeLists('expand', _nextExpandItemValues, props);\n    _this.state = {\n      data: data,\n      value: _value,\n      dragging: false,\n      selectedValue: _this.getValue(props),\n      expandAll: getExpandAll(props),\n      filterData: _this.getFilterData(nextData, _searchKeyword, props),\n      activeNode: _this.getActiveNode(_this.getValue(props), _valueKey),\n      searchKeyword: _searchKeyword,\n      expandItemValues: _this.serializeList('expand'),\n      dragNodeKeys: [],\n      dragOverNodeKey: null,\n      dropNodePosition: null\n    };\n    _this.treeViewRef = React.createRef();\n    _this.positionRef = React.createRef();\n    _this.listRef = React.createRef();\n    _this.triggerRef = React.createRef();\n    _this.toggleRef = React.createRef(); // for test\n\n    _this.menuRef = React.createRef();\n    treeDeprecatedWarning(props, ['expandAll']);\n    return _this;\n  }\n  var _proto = TreePicker.prototype;\n  _proto.componentDidMount = function componentDidMount() {\n    var activeNode = this.state.activeNode;\n    this.focusNode(activeNode);\n  };\n  TreePicker.getDerivedStateFromProps = function getDerivedStateFromProps(nextProps, prevState) {\n    var value = nextProps.value,\n      data = nextProps.data,\n      expandAll = nextProps.expandAll,\n      searchKeyword = nextProps.searchKeyword,\n      expandItemValues = nextProps.expandItemValues;\n    var nextState = {};\n    if (_isArray(data) && _isArray(prevState.data) && prevState.data !== data) {\n      nextState.data = data;\n    }\n    if (!shallowEqual(value, prevState.value)) {\n      nextState.value = value;\n      nextState.selectedValue = value;\n    }\n    if (compareArray(expandItemValues, prevState.expandItemValues) && Array.isArray(expandItemValues)) {\n      nextState.expandItemValues = expandItemValues;\n    }\n    if (!_isUndefined(searchKeyword) && searchKeyword !== prevState.searchKeyword) {\n      nextState.searchKeyword = searchKeyword;\n    }\n    if (expandAll !== prevState.expandAll) {\n      nextState.expandAll = expandAll;\n    }\n    return Object.keys(nextState).length ? nextState : null;\n  };\n  _proto.componentDidUpdate = function componentDidUpdate(_prevProps, prevState) {\n    this.updateDataChange(prevState);\n    this.updateValueChange(prevState);\n    this.updateExpandItemValuesChange(prevState);\n    this.updateSearchKeywordChange(prevState);\n    if (this.listRef.current) {\n      this.listRef.current.forceUpdateGrid();\n    }\n  };\n  _proto.updateDataChange = function updateDataChange(prevState) {\n    var _this$state4 = this.state,\n      searchKeyword = _this$state4.searchKeyword,\n      expandItemValues = _this$state4.expandItemValues;\n    var data = this.props.data;\n    if (prevState.data !== data) {\n      var nextData = [].concat(data);\n      this.flattenNodes(nextData);\n      var filterData = this.getFilterData(nextData, searchKeyword);\n      var activeNode = this.getActiveNode(this.getValue());\n      this.focusNode(activeNode);\n      this.unserializeLists('expand', expandItemValues);\n      var newState = {};\n      if (activeNode) {\n        newState = {\n          activeNode: activeNode\n        };\n      }\n      this.setState(_extends({}, {\n        data: nextData,\n        filterData: filterData,\n        expandItemValues: this.serializeList('expand')\n      }, {}, newState));\n    }\n  };\n  _proto.updateValueChange = function updateValueChange(prevState) {\n    var _this$props12 = this.props,\n      value = _this$props12.value,\n      valueKey = _this$props12.valueKey;\n    if (!shallowEqual(prevState.value, value)) {\n      var activeNode = null;\n      if (this.node === null) {\n        activeNode = this.getActiveNode(value);\n      }\n      if (value !== null && this.node !== null) {\n        activeNode = shallowEqual(this.node[valueKey], value) ? this.node : this.getActiveNode(value);\n      }\n      var nextState = {\n        value: value,\n        activeNode: activeNode\n      };\n      if (value === null) {\n        nextState.activeNode = null;\n        this.node = null;\n      }\n      if (activeNode !== null) {\n        this.focusNode(activeNode);\n      }\n      this.setState(nextState);\n    }\n  };\n  _proto.updateExpandItemValuesChange = function updateExpandItemValuesChange(prevState) {\n    var expandItemValues = this.props.expandItemValues;\n    if (compareArray(expandItemValues, prevState.expandItemValues) && Array.isArray(expandItemValues)) {\n      this.unserializeLists('expand', expandItemValues);\n      this.setState({\n        expandItemValues: expandItemValues\n      });\n    }\n  };\n  _proto.updateSearchKeywordChange = function updateSearchKeywordChange(prevState) {\n    var filterData = this.state.filterData;\n    if (!_isUndefined(this.props.searchKeyword) && prevState.searchKeyword !== this.props.searchKeyword) {\n      this.setState({\n        filterData: this.getFilterData(filterData, this.props.searchKeyword)\n      });\n    }\n  };\n  _proto.getValue = function getValue(props) {\n    if (props === void 0) {\n      props = this.props;\n    }\n    var _props = props,\n      value = _props.value,\n      defaultValue = _props.defaultValue;\n    return !_isUndefined(value) ? value : defaultValue;\n  };\n  _proto.getActiveNode = function getActiveNode(value, valueKey) {\n    var _this4 = this;\n    if (valueKey === void 0) {\n      valueKey = this.props.valueKey;\n    }\n    var activeNode = null;\n    if (!_isUndefined(value)) {\n      Object.keys(this.nodes).forEach(function (refKey) {\n        if (shallowEqual(_this4.nodes[refKey][valueKey], value)) {\n          activeNode = _this4.nodes[refKey];\n        }\n      });\n    }\n    return activeNode;\n  };\n  _proto.getActiveElementOption = function getActiveElementOption(options, value) {\n    var childrenKey = this.props.childrenKey;\n    for (var i = 0; i < options.length; i += 1) {\n      var _options$i$childrenKe;\n      if (options[i].value === value) {\n        return options[i];\n      } else if ((_options$i$childrenKe = options[i][childrenKey]) === null || _options$i$childrenKe === void 0 ? void 0 : _options$i$childrenKe.length) {\n        var active = this.getActiveElementOption(options[i][childrenKey], value);\n        if (!_isEmpty(active)) {\n          return active;\n        }\n      }\n    }\n    return {};\n  };\n  _proto.getItemsAndActiveIndex = function getItemsAndActiveIndex() {\n    var items = this.getFocusableMenuItems();\n    var activeIndex = -1;\n    items.forEach(function (item, index) {\n      if (document.activeElement !== null) {\n        if (item.refKey === document.activeElement.getAttribute('data-key')) {\n          activeIndex = index;\n        }\n      }\n    });\n    return {\n      items: items,\n      activeIndex: activeIndex\n    };\n  };\n  _proto.getActiveItem = function getActiveItem() {\n    var nodeData = {};\n    var activeItem = document.activeElement;\n    if (activeItem !== null) {\n      var _get2 = _get(activeItem, 'dataset'),\n        key = _get2.key,\n        layer = _get2.layer;\n      var activeNode = this.nodes[key];\n      if (activeNode) {\n        nodeData = activeNode;\n      }\n      return {\n        nodeData: nodeData,\n        layer: layer\n      };\n    }\n    return {};\n  };\n  _proto.getFilterData = function getFilterData(data, word, props) {\n    if (word === void 0) {\n      word = '';\n    }\n    var _ref2 = props || this.props,\n      labelKey = _ref2.labelKey,\n      childrenKey = _ref2.childrenKey,\n      searchBy = _ref2.searchBy;\n    var setVisible = function setVisible(nodes) {\n      if (nodes === void 0) {\n        nodes = [];\n      }\n      return nodes.forEach(function (item) {\n        item.visible = searchBy ? searchBy(word, item[labelKey], item) : shouldDisplay(item[labelKey], word);\n        if (_isArray(item[childrenKey])) {\n          setVisible(item[childrenKey]);\n          item[childrenKey].forEach(function (child) {\n            if (child.visible) {\n              item.visible = child.visible;\n            }\n          });\n        }\n      });\n    };\n    if (!_isUndefined(word)) {\n      setVisible(data);\n    }\n    return data;\n  };\n  _proto.getFlattenTreeData = function getFlattenTreeData(nodes) {\n    var _this5 = this;\n    var expandItemValues = this.state.expandItemValues;\n    var _this$props13 = this.props,\n      childrenKey = _this$props13.childrenKey,\n      valueKey = _this$props13.valueKey;\n    return flattenTree(nodes, childrenKey, function (node) {\n      var formatted = {};\n      var curNode = _this5.nodes[node.refKey];\n      var parentKeys = getNodeParents(curNode, 'parentNode', valueKey);\n      if (curNode) {\n        formatted = _extends({}, node, {\n          expand: curNode.expand,\n          layer: curNode.layer,\n          parentNode: curNode.parentNode,\n          showNode: shouldShowNodeByExpanded(expandItemValues, parentKeys)\n        });\n      }\n      return formatted;\n    });\n  };\n  _proto.getTreeNodeProps = function getTreeNodeProps(node, layer, index) {\n    var _this$state5 = this.state,\n      dragOverNodeKey = _this$state5.dragOverNodeKey,\n      selectedValue = _this$state5.selectedValue,\n      dropNodePosition = _this$state5.dropNodePosition;\n    var dragNode = this.dragNode || {};\n    var _this$props14 = this.props,\n      locale = _this$props14.locale,\n      valueKey = _this$props14.valueKey,\n      labelKey = _this$props14.labelKey,\n      draggable = _this$props14.draggable,\n      childrenKey = _this$props14.childrenKey,\n      _this$props14$disable = _this$props14.disabledItemValues,\n      disabledItemValues = _this$props14$disable === void 0 ? [] : _this$props14$disable,\n      renderTreeNode = _this$props14.renderTreeNode,\n      renderTreeIcon = _this$props14.renderTreeIcon;\n    return {\n      rtl: locale.rtl,\n      value: node[valueKey],\n      label: node[labelKey],\n      index: index,\n      layer: layer,\n      expand: node.expand,\n      active: shallowEqual(node[valueKey], selectedValue),\n      visible: node.visible,\n      draggable: draggable,\n      dragging: shallowEqual(node[valueKey], dragNode[valueKey]),\n      children: node[childrenKey],\n      nodeData: node,\n      disabled: disabledItemValues.some(function (disabledItem) {\n        return shallowEqual(disabledItem, node[valueKey]);\n      }),\n      dragOver: shallowEqual(node[valueKey], dragOverNodeKey) && dropNodePosition === TREE_NODE_DROP_POSITION.DRAG_OVER,\n      dragOverTop: shallowEqual(node[valueKey], dragOverNodeKey) && dropNodePosition === TREE_NODE_DROP_POSITION.DRAG_OVER_TOP,\n      dragOverBottom: shallowEqual(node[valueKey], dragOverNodeKey) && dropNodePosition === TREE_NODE_DROP_POSITION.DRAG_OVER_BOTTOM,\n      onSelect: this.handleSelect,\n      onDragStart: this.handleDragStart,\n      onDragEnter: this.handleDragEnter,\n      onDragOver: this.handleDragOver,\n      onDragLeave: this.handleDragLeave,\n      onDragEnd: this.handleDragEnd,\n      onDrop: this.handleDrop,\n      onTreeToggle: this.handleToggle,\n      onRenderTreeNode: renderTreeNode,\n      onRenderTreeIcon: renderTreeIcon\n    };\n  }\n  /**\n   * 获取 onDrop 的回调数据\n   */;\n\n  _proto.getDropData = function getDropData(nodeData) {\n    var dropNodePosition = this.state.dropNodePosition;\n    var _this$props15 = this.props,\n      valueKey = _this$props15.valueKey,\n      childrenKey = _this$props15.childrenKey;\n    var options = {\n      valueKey: valueKey,\n      childrenKey: childrenKey\n    };\n    var dragNode = _omit(this.dragNode, 'parentNode');\n    return {\n      /** 拖拽节点 */\n      dragNode: dragNode,\n      /** 释放所在节点的父节点 */\n      dropNode: nodeData,\n      /** 拖拽节点的类型 */\n      dropNodePosition: dropNodePosition,\n      createUpdateDataFunction: createUpdateTreeDataFunction({\n        /** 拖拽节点 */\n        dragNode: dragNode,\n        /** 释放所在节点的父节点 */\n        dropNode: nodeData,\n        /** 拖拽节点的类型 */\n        dropNodePosition: dropNodePosition\n      }, options)\n    };\n  };\n  _proto.focusNode = function focusNode(activeNode) {\n    var inline = this.props.inline;\n    if (activeNode && inline) {\n      var _node$focus4;\n      var node = this.getElementByDataKey(activeNode.refKey);\n      node === null || node === void 0 ? void 0 : (_node$focus4 = node.focus) === null || _node$focus4 === void 0 ? void 0 : _node$focus4.call(node);\n    }\n  };\n  _proto.flattenNodes = function flattenNodes(nodes, props, ref, parentNode, layer) {\n    var _this6 = this;\n    if (ref === void 0) {\n      ref = '0';\n    }\n    if (layer === void 0) {\n      layer = 0;\n    }\n    var _ref3 = props || this.props,\n      labelKey = _ref3.labelKey,\n      valueKey = _ref3.valueKey,\n      childrenKey = _ref3.childrenKey;\n    if (!Array.isArray(nodes) || nodes.length === 0) {\n      return [];\n    }\n    nodes.map(function (node, index) {\n      var _extends2;\n      var refKey = ref + \"-\" + index;\n      node.refKey = refKey;\n      _this6.nodes[refKey] = _extends((_extends2 = {\n        layer: layer\n      }, _extends2[labelKey] = node[labelKey], _extends2[valueKey] = node[valueKey], _extends2.expand = getExpandState(node, props || _this6.props), _extends2.refKey = refKey, _extends2), node);\n      if (parentNode) {\n        _this6.nodes[refKey].parentNode = parentNode;\n      }\n      _this6.flattenNodes(node[childrenKey], props, refKey, _this6.nodes[refKey], layer + 1);\n    });\n  };\n  _proto.serializeList = function serializeList(key, nodes) {\n    if (nodes === void 0) {\n      nodes = this.nodes;\n    }\n    var valueKey = this.props.valueKey;\n    var list = [];\n    Object.keys(nodes).forEach(function (refKey) {\n      if (nodes[refKey][key]) {\n        list.push(nodes[refKey][valueKey]);\n      }\n    });\n    return list;\n  };\n  _proto.unserializeLists = function unserializeLists(key, value, props) {\n    var _this7 = this;\n    if (value === void 0) {\n      value = [];\n    }\n    if (props === void 0) {\n      props = this.props;\n    }\n    var _props2 = props,\n      valueKey = _props2.valueKey;\n    var expandAll = getExpandAll(props);\n    Object.keys(this.nodes).forEach(function (refKey) {\n      _this7.nodes[refKey][key] = false;\n      if (value.length) {\n        value.forEach(function (value) {\n          if (shallowEqual(_this7.nodes[refKey][valueKey], value)) {\n            _this7.nodes[refKey][key] = true;\n          }\n        });\n      } else {\n        _this7.nodes[refKey][key] = expandAll;\n      }\n    });\n  };\n  _proto.toggleExpand = function toggleExpand(node, isExpand) {\n    var valueKey = this.props.valueKey;\n    var expandItemValues = new Set(this.serializeList('expand'));\n    if (isExpand) {\n      expandItemValues.add(node[valueKey]);\n    } else {\n      expandItemValues.delete(node[valueKey]);\n    }\n    return Array.from(expandItemValues);\n  };\n  _proto.renderDropdownMenu = function renderDropdownMenu() {\n    var _this$props16 = this.props,\n      searchable = _this$props16.searchable,\n      searchKeyword = _this$props16.searchKeyword,\n      renderExtraFooter = _this$props16.renderExtraFooter,\n      locale = _this$props16.locale,\n      renderMenu = _this$props16.renderMenu,\n      menuStyle = _this$props16.menuStyle,\n      menuClassName = _this$props16.menuClassName,\n      menuAutoWidth = _this$props16.menuAutoWidth;\n    var keyword = !_isUndefined(searchKeyword) ? searchKeyword : this.state.searchKeyword;\n    var classes = classNames(menuClassName, this.addPrefix('tree-menu'));\n    return React.createElement(MenuWrapper, {\n      autoWidth: menuAutoWidth,\n      className: classes,\n      style: menuStyle,\n      ref: this.menuRef,\n      getToggleInstance: this.getToggleInstance,\n      getPositionInstance: this.getPositionInstance\n    }, searchable ? React.createElement(SearchBar, {\n      placeholder: locale.searchPlaceholder,\n      key: \"searchBar\",\n      onChange: this.handleSearch,\n      value: keyword\n    }) : null, renderMenu ? renderMenu(this.renderTree()) : this.renderTree(), renderExtraFooter === null || renderExtraFooter === void 0 ? void 0 : renderExtraFooter());\n  };\n  _proto.renderNode = function renderNode(node, index, layer) {\n    var _this8 = this;\n    var searchKeyword = this.state.searchKeyword;\n    var _this$props17 = this.props,\n      valueKey = _this$props17.valueKey,\n      childrenKey = _this$props17.childrenKey;\n    if (!node.visible) {\n      return null;\n    }\n    var refKey = node.refKey;\n    var expand = getExpandWhenSearching(searchKeyword, this.nodes[refKey].expand);\n    var key = _isString(node[valueKey]) || _isNumber(node[valueKey]) ? node[valueKey] : refKey;\n    var children = node[childrenKey]; // 当用户进行搜索时，hasChildren的判断要变成判断是否存在 visible 为 true 的子节点\n\n    var visibleChildren = _isUndefined(searchKeyword) || searchKeyword.length === 0 ? !!children : hasVisibleChildren(node, childrenKey);\n    var nodeProps = _extends({}, this.getTreeNodeProps(_extends({}, node, {\n      expand: expand\n    }), layer, index), {\n      hasChildren: visibleChildren\n    });\n    if (nodeProps.hasChildren) {\n      var _classNames;\n      layer += 1; // 是否展开树节点且子节点不为空\n\n      var openClass = this.addTreePrefix('open');\n      var childrenClass = classNames(this.addTreePrefix('node-children'), (_classNames = {}, _classNames[openClass] = expand && visibleChildren, _classNames));\n      var nodes = children || [];\n      return React.createElement(\"div\", {\n        className: childrenClass,\n        key: key\n      }, React.createElement(TreeNode, _extends({}, nodeProps, {\n        innerRef: this.bindNodeRefs.bind(this, refKey)\n      })), React.createElement(\"div\", {\n        className: this.addTreePrefix('children')\n      }, nodes.map(function (child, i) {\n        return _this8.renderNode(child, i, layer);\n      })));\n    }\n    return React.createElement(TreeNode, _extends({\n      key: key,\n      innerRef: this.bindNodeRefs.bind(this, refKey)\n    }, nodeProps));\n  };\n  _proto.renderVirtualNode = function renderVirtualNode(node, options) {\n    var searchKeyword = this.state.searchKeyword;\n    var childrenKey = this.props.childrenKey;\n    var key = options.key,\n      style = options.style;\n    var layer = node.layer,\n      refKey = node.refKey,\n      showNode = node.showNode;\n    var expand = getExpandWhenSearching(searchKeyword, this.nodes[refKey].expand);\n    if (!node.visible) {\n      return null;\n    }\n    var nodeProps = _extends({}, this.getTreeNodeProps(_extends({}, node, {\n      expand: expand\n    }), layer), {\n      style: style,\n      hasChildren: !!node[childrenKey]\n    });\n    return showNode && React.createElement(TreeNode, _extends({\n      key: key,\n      innerRef: this.bindNodeRefs.bind(this, refKey)\n    }, nodeProps));\n  };\n  _proto.renderTree = function renderTree() {\n    var _classNames2,\n      _this9 = this;\n    var filterData = this.state.filterData;\n    var _this$props18 = this.props,\n      height = _this$props18.height,\n      className = _this$props18.className,\n      inline = _this$props18.inline,\n      style = _this$props18.style,\n      locale = _this$props18.locale,\n      virtualized = _this$props18.virtualized;\n    var layer = 0;\n    var classes = classNames(defaultClassPrefix('tree'), (_classNames2 = {}, _classNames2[className] = inline, _classNames2));\n    var nodes = [];\n    if (!virtualized) {\n      nodes = filterData.map(function (dataItem, index) {\n        return _this9.renderNode(dataItem, index, layer);\n      });\n      if (!nodes.some(function (v) {\n        return v !== null;\n      })) {\n        return React.createElement(\"div\", {\n          className: this.addPrefix('none')\n        }, locale.noResultsText);\n      }\n    } else {\n      nodes = this.getFlattenTreeData(filterData).filter(function (n) {\n        return n.showNode && n.visible;\n      });\n      if (!nodes.length) {\n        return React.createElement(\"div\", {\n          className: this.addPrefix('none')\n        }, locale.noResultsText);\n      }\n    } // The height of virtualized tree should be subtract the value of paddingBottom\n\n    var treeHeight = height - 12;\n    var treeWidth = _isUndefined(style === null || style === void 0 ? void 0 : style.width) ? defaultWidth : style.width;\n    var listStyles = inline ? _extends({\n      height: height\n    }, style) : style;\n    return React.createElement(React.Fragment, null, React.createElement(\"div\", {\n      ref: this.treeViewRef,\n      className: classes,\n      style: listStyles,\n      onKeyDown: this.handleKeyDown\n    }, React.createElement(\"div\", {\n      className: this.addTreePrefix('nodes')\n    }, virtualized ? React.createElement(AutoSizer, {\n      defaultHeight: treeHeight,\n      defaultWidth: treeWidth,\n      style: {\n        width: 'auto',\n        height: 'auto'\n      }\n    }, function (_ref4) {\n      var height = _ref4.height,\n        width = _ref4.width;\n      return React.createElement(List, {\n        ref: _this9.listRef,\n        width: width || treeWidth,\n        height: height,\n        rowHeight: 36,\n        rowCount: nodes.length,\n        rowRenderer: _this9.measureRowRenderer(nodes)\n      });\n    }) : nodes)), this.renderDragNode());\n  };\n  _proto.renderDragNode = function renderDragNode() {\n    var _this$props19 = this.props,\n      labelKey = _this$props19.labelKey,\n      draggable = _this$props19.draggable,\n      renderDragNode = _this$props19.renderDragNode;\n    var dragNode = this.dragNode || {};\n    if (draggable) {\n      var dragNodeContent = dragNode[labelKey];\n      if (_isFunction(renderDragNode)) {\n        dragNodeContent = renderDragNode(dragNode);\n      }\n      return React.createElement(\"span\", {\n        id: \"drag-node\",\n        className: this.addTreePrefix('drag-node-mover')\n      }, dragNodeContent);\n    }\n    return null;\n  };\n  _proto.render = function render() {\n    var _this$props20 = this.props,\n      inline = _this$props20.inline,\n      locale = _this$props20.locale,\n      disabled = _this$props20.disabled,\n      toggleComponentClass = _this$props20.toggleComponentClass,\n      placeholder = _this$props20.placeholder,\n      cleanable = _this$props20.cleanable,\n      renderValue = _this$props20.renderValue,\n      labelKey = _this$props20.labelKey,\n      onEntered = _this$props20.onEntered,\n      onExited = _this$props20.onExited,\n      onClean = _this$props20.onClean,\n      style = _this$props20.style,\n      positionRef = _this$props20.positionRef,\n      rest = _objectWithoutPropertiesLoose(_this$props20, [\"inline\", \"locale\", \"disabled\", \"toggleComponentClass\", \"placeholder\", \"cleanable\", \"renderValue\", \"labelKey\", \"onEntered\", \"onExited\", \"onClean\", \"style\", \"positionRef\"]);\n    var _this$state6 = this.state,\n      selectedValue = _this$state6.selectedValue,\n      activeNode = _this$state6.activeNode;\n    var hasValidValue = !_isNil(activeNode) || !_isNil(selectedValue) && _isFunction(renderValue);\n    var selectedElement = placeholder;\n    var hasValue = !!activeNode;\n    /**\n     * if value is invalid and renderValue is undefined, then using placeholder.\n     * if value is valid and renderValue is't undefined, then using renderValue()\n     */\n\n    if (!_isNil(selectedValue)) {\n      if (hasValue) {\n        selectedElement = activeNode[labelKey];\n      }\n      if (_isFunction(renderValue)) {\n        var node = activeNode !== null && activeNode !== void 0 ? activeNode : {};\n        selectedElement = renderValue(selectedValue, node, selectedElement);\n        if (_isNil(selectedElement)) {\n          hasValidValue = false;\n        }\n      }\n    }\n    var unhandled = getUnhandledProps(TreePicker, rest);\n    var classes = getToggleWrapperClassName('tree', this.addPrefix, this.props, hasValidValue);\n    if (inline) {\n      return this.renderTree();\n    }\n    return React.createElement(PickerToggleTrigger, {\n      pickerProps: this.props,\n      ref: this.triggerRef,\n      positionRef: mergeRefs(this.positionRef, positionRef),\n      onEntered: createChainedFunction(this.handleOnOpen, onEntered),\n      onExited: createChainedFunction(this.handleOnClose, onExited),\n      speaker: this.renderDropdownMenu()\n    }, React.createElement(\"div\", {\n      className: classes,\n      style: style\n    }, React.createElement(PickerToggle, _extends({}, unhandled, {\n      ref: this.toggleRef,\n      onKeyDown: this.handleToggleKeyDown,\n      onClean: createChainedFunction(this.handleClean, onClean),\n      cleanable: cleanable && !disabled,\n      componentClass: toggleComponentClass,\n      hasValue: hasValidValue,\n      active: this.state.active,\n      \"aria-disabled\": disabled\n    }), selectedElement || locale.placeholder)));\n  };\n  return TreePicker;\n}(React.Component);\nTreePicker.propTypes = _extends({}, listPickerPropTypes, {\n  height: PropTypes.number,\n  inline: PropTypes.bool,\n  draggable: PropTypes.bool,\n  expandAll: PropTypes.bool,\n  virtualized: PropTypes.bool,\n  searchable: PropTypes.bool,\n  menuAutoWidth: PropTypes.bool,\n  searchKeyword: PropTypes.string,\n  defaultExpandAll: PropTypes.bool,\n  expandItemValues: PropTypes.array,\n  defaultExpandItemValues: PropTypes.array,\n  onSearch: PropTypes.func,\n  onExpand: PropTypes.func,\n  onSelect: PropTypes.func,\n  renderMenu: PropTypes.func,\n  renderTreeNode: PropTypes.func,\n  renderTreeIcon: PropTypes.func,\n  renderExtraFooter: PropTypes.func,\n  renderDragNode: PropTypes.func,\n  searchBy: PropTypes.func\n});\nTreePicker.defaultProps = _extends({}, listPickerDefaultProps, {\n  height: defaultHeight,\n  searchable: true,\n  menuAutoWidth: true,\n  locale: {\n    placeholder: 'Select',\n    searchPlaceholder: 'Search',\n    noResultsText: 'No results found'\n  }\n});\npolyfill(TreePicker);\nexport default defaultProps({\n  classPrefix: 'picker'\n})(TreePicker);","map":{"version":3,"names":["_objectWithoutPropertiesLoose","_extends","_inheritsLoose","_isNil","_isFunction","_isNumber","_isString","_omit","_get","_isEmpty","_isUndefined","_isArray","React","PropTypes","classNames","List","AutoSizer","CellMeasurerCache","CellMeasurer","polyfill","shallowEqual","TreeNode","defaultProps","prefix","defaultClassPrefix","getUnhandledProps","createChainedFunction","mergeRefs","flattenTree","getExpandWhenSearching","getNodeParents","shouldShowNodeByExpanded","treeDeprecatedWarning","hasVisibleChildren","compareArray","getExpandAll","getExpandItemValues","getExpandState","getDragNodeKeys","calDropNodePosition","createUpdateTreeDataFunction","PickerToggle","getToggleWrapperClassName","onMenuKeyDown","MenuWrapper","SearchBar","PickerToggleTrigger","createConcatChildrenFunction","shouldDisplay","TREE_NODE_DROP_POSITION","listPickerPropTypes","listPickerDefaultProps","defaultHeight","defaultWidth","TreePicker","_React$Component","props","_this","call","menuRef","treeViewRef","positionRef","listRef","triggerRef","toggleRef","getFocusableMenuItems","filterData","state","_this$props","childrenKey","_this$props$disabledI","disabledItemValues","valueKey","items","loop","nodes","forEach","node","nodeData","refKey","disabled","some","disabledItem","push","getElementByDataKey","dataKey","ele","nodeRefs","Element","querySelector","addTreePrefix","cache","fixedWidth","minHeight","dragNode","bindNodeRefs","ref","getPositionInstance","current","getToggleInstance","addPrefix","name","classPrefix","selectActiveItem","event","_this$getActiveItem","getActiveItem","handleSelect","focusNextItem","_node$focus","_this$getItemsAndActi","getItemsAndActiveIndex","activeIndex","length","nextIndex","focus","focusPreviousItem","_node$focus2","_this$getItemsAndActi2","prevIndex","handleCloseDropdown","_this$triggerRef$curr","_this$triggerRef$curr2","hide","handleOpenDropdown","_this$triggerRef$curr3","_this$triggerRef$curr4","show","open","_this$handleOpenDropd","_this2","close","_this$handleCloseDrop","_this3","handleToggleDropdown","active","handleToggle","_this$props2","onExpand","expandItemValues","nextExpandItemValues","toggleExpand","expand","unserializeLists","setState","_this$toggleRef$curre","_this$props3","onChange","onSelect","value","activeNode","selectedValue","onFocus","handleKeyDown","down","up","enter","del","handleClean","handleToggleKeyDown","_this$state","keyCode","target","HTMLElement","className","includes","handleSearch","_this$props4","onSearch","searchKeyword","getFilterData","_this$props$onChange","_this$props5","handleOnOpen","_this$props$onOpen","_this$props6","_node$focus3","onOpen","handleOnClose","_this$props7","onClose","handleDragStart","_this$props8","onDragStart","draggable","dragging","dragNodeKeys","handleDragEnter","_this$state2","_this$props9","onDragEnter","d","dropNodePosition","dragOverNodeKey","handleDragOver","_this$state3","_this$props10","onDragOver","lastDropNodePosition","handleDragLeave","onDragLeave","handleDragEnd","onDragEnd","handleDrop","_this$props11","onDrop","console","error","dropData","getDropData","measureRowRenderer","_ref","key","index","style","parent","createElement","columnIndex","rowIndex","renderVirtualNode","_value","data","_valueKey","_props$searchKeyword","_searchKeyword","nextData","concat","_nextExpandItemValues","flattenNodes","getValue","expandAll","getActiveNode","serializeList","createRef","_proto","prototype","componentDidMount","focusNode","getDerivedStateFromProps","nextProps","prevState","nextState","Array","isArray","Object","keys","componentDidUpdate","_prevProps","updateDataChange","updateValueChange","updateExpandItemValuesChange","updateSearchKeywordChange","forceUpdateGrid","_this$state4","newState","_this$props12","_props","defaultValue","_this4","getActiveElementOption","options","i","_options$i$childrenKe","item","document","activeElement","getAttribute","activeItem","_get2","layer","word","_ref2","labelKey","searchBy","setVisible","visible","child","getFlattenTreeData","_this5","_this$props13","formatted","curNode","parentKeys","parentNode","showNode","getTreeNodeProps","_this$state5","_this$props14","locale","_this$props14$disable","renderTreeNode","renderTreeIcon","rtl","label","children","dragOver","DRAG_OVER","dragOverTop","DRAG_OVER_TOP","dragOverBottom","DRAG_OVER_BOTTOM","onTreeToggle","onRenderTreeNode","onRenderTreeIcon","_this$props15","dropNode","createUpdateDataFunction","inline","_node$focus4","_this6","_ref3","map","_extends2","list","_this7","_props2","isExpand","Set","add","delete","from","renderDropdownMenu","_this$props16","searchable","renderExtraFooter","renderMenu","menuStyle","menuClassName","menuAutoWidth","keyword","classes","autoWidth","placeholder","searchPlaceholder","renderTree","renderNode","_this8","_this$props17","visibleChildren","nodeProps","hasChildren","_classNames","openClass","childrenClass","innerRef","bind","_classNames2","_this9","_this$props18","height","virtualized","dataItem","v","noResultsText","filter","n","treeHeight","treeWidth","width","listStyles","Fragment","onKeyDown","_ref4","rowHeight","rowCount","rowRenderer","renderDragNode","_this$props19","dragNodeContent","id","render","_this$props20","toggleComponentClass","cleanable","renderValue","onEntered","onExited","onClean","rest","_this$state6","hasValidValue","selectedElement","hasValue","unhandled","pickerProps","speaker","componentClass","Component","propTypes","number","bool","string","defaultExpandAll","array","defaultExpandItemValues","func"],"sources":["/Users/azminds/Documents/five-g/frontend/node_modules/rsuite/es/TreePicker/TreePicker.js"],"sourcesContent":["import _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _inheritsLoose from \"@babel/runtime/helpers/esm/inheritsLoose\";\nimport _isNil from \"lodash/isNil\";\nimport _isFunction from \"lodash/isFunction\";\nimport _isNumber from \"lodash/isNumber\";\nimport _isString from \"lodash/isString\";\nimport _omit from \"lodash/omit\";\nimport _get from \"lodash/get\";\nimport _isEmpty from \"lodash/isEmpty\";\nimport _isUndefined from \"lodash/isUndefined\";\nimport _isArray from \"lodash/isArray\";\nimport * as React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport List from 'react-virtualized/dist/commonjs/List';\nimport AutoSizer from 'react-virtualized/dist/commonjs/AutoSizer';\nimport { CellMeasurerCache, CellMeasurer } from 'react-virtualized/dist/commonjs/CellMeasurer';\nimport { polyfill } from 'react-lifecycles-compat';\nimport shallowEqual from '../utils/shallowEqual';\nimport TreeNode from './TreeNode';\nimport { defaultProps, prefix, defaultClassPrefix, getUnhandledProps, createChainedFunction, mergeRefs } from '../utils';\nimport { flattenTree, getExpandWhenSearching, getNodeParents, shouldShowNodeByExpanded, treeDeprecatedWarning, hasVisibleChildren, compareArray, getExpandAll, getExpandItemValues, getExpandState, getDragNodeKeys, calDropNodePosition, createUpdateTreeDataFunction } from '../utils/treeUtils';\nimport { PickerToggle, getToggleWrapperClassName, onMenuKeyDown, MenuWrapper, SearchBar, PickerToggleTrigger, createConcatChildrenFunction, shouldDisplay } from '../Picker';\nimport { TREE_NODE_DROP_POSITION } from '../constants';\nimport { listPickerPropTypes, listPickerDefaultProps } from '../Picker/propTypes'; // default value for virtualized\n\nvar defaultHeight = 360;\nvar defaultWidth = 200;\n\nvar TreePicker =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inheritsLoose(TreePicker, _React$Component);\n\n  function TreePicker(props) {\n    var _this;\n\n    _this = _React$Component.call(this, props) || this;\n    _this.menuRef = void 0;\n    _this.treeViewRef = void 0;\n    _this.positionRef = void 0;\n    _this.listRef = void 0;\n    _this.triggerRef = void 0;\n    _this.toggleRef = void 0;\n\n    _this.getFocusableMenuItems = function () {\n      var filterData = _this.state.filterData;\n      var _this$props = _this.props,\n          childrenKey = _this$props.childrenKey,\n          _this$props$disabledI = _this$props.disabledItemValues,\n          disabledItemValues = _this$props$disabledI === void 0 ? [] : _this$props$disabledI,\n          valueKey = _this$props.valueKey;\n      var items = [];\n\n      var loop = function loop(nodes) {\n        nodes.forEach(function (node) {\n          var nodeData = _extends({}, node, {}, _this.nodes[node.refKey]);\n\n          var disabled = disabledItemValues.some(function (disabledItem) {\n            return shallowEqual(disabledItem, node[valueKey]);\n          });\n\n          if (!disabled) {\n            items.push(node);\n          }\n\n          if (node[childrenKey] && getExpandState(nodeData, _this.props)) {\n            loop(node[childrenKey]);\n          }\n        });\n      };\n\n      loop(filterData);\n      return items;\n    };\n\n    _this.getElementByDataKey = function (dataKey) {\n      var ele = _this.nodeRefs[dataKey];\n\n      if (ele instanceof Element) {\n        return ele.querySelector(\".\" + _this.addTreePrefix('node-label'));\n      }\n\n      return null;\n    };\n\n    _this.nodes = {};\n    _this.node = null;\n    _this.cache = new CellMeasurerCache({\n      fixedWidth: true,\n      minHeight: 20\n    });\n    _this.nodeRefs = {};\n    _this.dragNode = null;\n\n    _this.bindNodeRefs = function (refKey, ref) {\n      _this.nodeRefs[refKey] = ref;\n    };\n\n    _this.getPositionInstance = function () {\n      return _this.positionRef.current;\n    };\n\n    _this.getToggleInstance = function () {\n      return _this.toggleRef.current;\n    };\n\n    _this.addPrefix = function (name) {\n      return prefix(_this.props.classPrefix)(name);\n    };\n\n    _this.addTreePrefix = function (name) {\n      return prefix(defaultClassPrefix('tree'))(name);\n    };\n\n    _this.selectActiveItem = function (event) {\n      var _this$getActiveItem = _this.getActiveItem(),\n          nodeData = _this$getActiveItem.nodeData;\n\n      _this.handleSelect(nodeData, event);\n    };\n\n    _this.focusNextItem = function () {\n      var _node$focus;\n\n      var _this$getItemsAndActi = _this.getItemsAndActiveIndex(),\n          items = _this$getItemsAndActi.items,\n          activeIndex = _this$getItemsAndActi.activeIndex;\n\n      if (items.length === 0) {\n        return;\n      }\n\n      var nextIndex = activeIndex === items.length - 1 ? 0 : activeIndex + 1;\n\n      var node = _this.getElementByDataKey(items[nextIndex].refKey);\n\n      node === null || node === void 0 ? void 0 : (_node$focus = node.focus) === null || _node$focus === void 0 ? void 0 : _node$focus.call(node);\n    };\n\n    _this.focusPreviousItem = function () {\n      var _node$focus2;\n\n      var _this$getItemsAndActi2 = _this.getItemsAndActiveIndex(),\n          items = _this$getItemsAndActi2.items,\n          activeIndex = _this$getItemsAndActi2.activeIndex;\n\n      if (items.length === 0) {\n        return;\n      }\n\n      var prevIndex = activeIndex === 0 ? items.length - 1 : activeIndex - 1;\n      prevIndex = prevIndex >= 0 ? prevIndex : 0;\n\n      var node = _this.getElementByDataKey(items[prevIndex].refKey);\n\n      node === null || node === void 0 ? void 0 : (_node$focus2 = node.focus) === null || _node$focus2 === void 0 ? void 0 : _node$focus2.call(node);\n    };\n\n    _this.handleCloseDropdown = function () {\n      var _this$triggerRef$curr, _this$triggerRef$curr2;\n\n      (_this$triggerRef$curr = _this.triggerRef.current) === null || _this$triggerRef$curr === void 0 ? void 0 : (_this$triggerRef$curr2 = _this$triggerRef$curr.hide) === null || _this$triggerRef$curr2 === void 0 ? void 0 : _this$triggerRef$curr2.call(_this$triggerRef$curr);\n    };\n\n    _this.handleOpenDropdown = function () {\n      var _this$triggerRef$curr3, _this$triggerRef$curr4;\n\n      (_this$triggerRef$curr3 = _this.triggerRef.current) === null || _this$triggerRef$curr3 === void 0 ? void 0 : (_this$triggerRef$curr4 = _this$triggerRef$curr3.show) === null || _this$triggerRef$curr4 === void 0 ? void 0 : _this$triggerRef$curr4.call(_this$triggerRef$curr3);\n    };\n\n    _this.open = function () {\n      var _this$handleOpenDropd, _this2;\n\n      (_this$handleOpenDropd = (_this2 = _this).handleOpenDropdown) === null || _this$handleOpenDropd === void 0 ? void 0 : _this$handleOpenDropd.call(_this2);\n    };\n\n    _this.close = function () {\n      var _this$handleCloseDrop, _this3;\n\n      (_this$handleCloseDrop = (_this3 = _this).handleCloseDropdown) === null || _this$handleCloseDrop === void 0 ? void 0 : _this$handleCloseDrop.call(_this3);\n    };\n\n    _this.handleToggleDropdown = function () {\n      var active = _this.state.active;\n\n      if (active) {\n        _this.handleCloseDropdown();\n\n        return;\n      }\n\n      _this.handleOpenDropdown();\n    };\n\n    _this.handleToggle = function (nodeData) {\n      var _this$props2 = _this.props,\n          valueKey = _this$props2.valueKey,\n          childrenKey = _this$props2.childrenKey,\n          onExpand = _this$props2.onExpand,\n          expandItemValues = _this$props2.expandItemValues;\n\n      var nextExpandItemValues = _this.toggleExpand(nodeData, !nodeData.expand);\n\n      if (_isUndefined(expandItemValues)) {\n        _this.unserializeLists('expand', nextExpandItemValues);\n\n        _this.setState({\n          expandItemValues: nextExpandItemValues\n        });\n      }\n\n      onExpand === null || onExpand === void 0 ? void 0 : onExpand(nextExpandItemValues, nodeData, createConcatChildrenFunction(nodeData, nodeData[valueKey], {\n        valueKey: valueKey,\n        childrenKey: childrenKey\n      }));\n    };\n\n    _this.handleSelect = function (nodeData, event) {\n      var _this$toggleRef$curre;\n\n      var _this$props3 = _this.props,\n          valueKey = _this$props3.valueKey,\n          onChange = _this$props3.onChange,\n          onSelect = _this$props3.onSelect,\n          value = _this$props3.value;\n      _this.node = nodeData;\n\n      if (_isUndefined(value)) {\n        _this.setState({\n          activeNode: nodeData,\n          selectedValue: nodeData[valueKey]\n        });\n      }\n\n      onChange === null || onChange === void 0 ? void 0 : onChange(nodeData[valueKey], event);\n      onSelect === null || onSelect === void 0 ? void 0 : onSelect(nodeData, nodeData[valueKey], event);\n\n      _this.handleCloseDropdown();\n\n      (_this$toggleRef$curre = _this.toggleRef.current) === null || _this$toggleRef$curre === void 0 ? void 0 : _this$toggleRef$curre.onFocus();\n    };\n\n    _this.handleKeyDown = function (event) {\n      onMenuKeyDown(event, {\n        down: _this.focusNextItem,\n        up: _this.focusPreviousItem,\n        enter: _this.selectActiveItem,\n        del: _this.handleClean\n      });\n    };\n\n    _this.handleToggleKeyDown = function (event) {\n      var _this$state = _this.state,\n          activeNode = _this$state.activeNode,\n          active = _this$state.active; // enter\n\n      if ((!activeNode || !active) && event.keyCode === 13) {\n        _this.handleToggleDropdown();\n      } // delete\n\n\n      if (event.keyCode === 8) {\n        _this.handleClean(event);\n      }\n\n      if (!_this.treeViewRef.current) {\n        return;\n      }\n\n      if (event.target instanceof HTMLElement) {\n        var className = event.target.className;\n\n        if (className.includes(_this.addPrefix('toggle')) || className.includes(_this.addPrefix('toggle-custom')) || className.includes(_this.addPrefix('search-bar-input'))) {\n          onMenuKeyDown(event, {\n            down: _this.focusNextItem\n          });\n        }\n      }\n    };\n\n    _this.handleSearch = function (value, event) {\n      var filterData = _this.state.filterData;\n      var _this$props4 = _this.props,\n          onSearch = _this$props4.onSearch,\n          searchKeyword = _this$props4.searchKeyword;\n\n      if (_isUndefined(searchKeyword)) {\n        _this.setState({\n          searchKeyword: value,\n          filterData: _this.getFilterData(filterData, value)\n        });\n      }\n\n      onSearch === null || onSearch === void 0 ? void 0 : onSearch(value, event);\n    };\n\n    _this.handleClean = function (event) {\n      var _this$props$onChange, _this$props5;\n\n      _this.setState({\n        activeNode: null,\n        selectedValue: null\n      });\n\n      _this.node = null;\n      (_this$props$onChange = (_this$props5 = _this.props).onChange) === null || _this$props$onChange === void 0 ? void 0 : _this$props$onChange.call(_this$props5, null, event);\n    };\n\n    _this.handleOnOpen = function () {\n      var _this$props$onOpen, _this$props6;\n\n      var activeNode = _this.state.activeNode;\n\n      if (activeNode) {\n        var _node$focus3;\n\n        var node = _this.getElementByDataKey(activeNode.refKey);\n\n        node === null || node === void 0 ? void 0 : (_node$focus3 = node.focus) === null || _node$focus3 === void 0 ? void 0 : _node$focus3.call(node);\n      }\n\n      (_this$props$onOpen = (_this$props6 = _this.props).onOpen) === null || _this$props$onOpen === void 0 ? void 0 : _this$props$onOpen.call(_this$props6);\n\n      _this.setState({\n        active: true\n      });\n    };\n\n    _this.handleOnClose = function () {\n      var filterData = _this.state.filterData;\n      var _this$props7 = _this.props,\n          searchKeyword = _this$props7.searchKeyword,\n          onClose = _this$props7.onClose;\n\n      if (_isUndefined(searchKeyword)) {\n        _this.setState({\n          searchKeyword: '',\n          filterData: _this.getFilterData(filterData, '')\n        });\n      }\n\n      onClose === null || onClose === void 0 ? void 0 : onClose();\n\n      _this.setState({\n        active: false\n      });\n    };\n\n    _this.handleDragStart = function (nodeData, event) {\n      var _this$props8 = _this.props,\n          valueKey = _this$props8.valueKey,\n          childrenKey = _this$props8.childrenKey,\n          onDragStart = _this$props8.onDragStart,\n          draggable = _this$props8.draggable;\n\n      if (draggable) {\n        _this.setState({\n          dragging: true,\n          dragNodeKeys: getDragNodeKeys(nodeData, childrenKey, valueKey)\n        });\n\n        _this.dragNode = _this.nodes[nodeData.refKey];\n        onDragStart === null || onDragStart === void 0 ? void 0 : onDragStart(nodeData, event);\n      }\n    };\n\n    _this.handleDragEnter = function (nodeData, event) {\n      var _this$state2 = _this.state,\n          dragging = _this$state2.dragging,\n          dragNodeKeys = _this$state2.dragNodeKeys;\n      var _this$props9 = _this.props,\n          valueKey = _this$props9.valueKey,\n          onDragEnter = _this$props9.onDragEnter;\n\n      if (dragNodeKeys.some(function (d) {\n        return shallowEqual(d, nodeData[valueKey]);\n      })) {\n        return;\n      }\n\n      if (dragging && _this.dragNode) {\n        var dropNodePosition = calDropNodePosition(event, _this.nodeRefs[nodeData.refKey]);\n\n        _this.setState({\n          dragOverNodeKey: nodeData[valueKey],\n          dropNodePosition: dropNodePosition\n        });\n      }\n\n      onDragEnter === null || onDragEnter === void 0 ? void 0 : onDragEnter(nodeData, event);\n    };\n\n    _this.handleDragOver = function (nodeData, event) {\n      var _this$state3 = _this.state,\n          dragNodeKeys = _this$state3.dragNodeKeys,\n          dragOverNodeKey = _this$state3.dragOverNodeKey,\n          dropNodePosition = _this$state3.dropNodePosition;\n      var _this$props10 = _this.props,\n          valueKey = _this$props10.valueKey,\n          onDragOver = _this$props10.onDragOver;\n\n      if (dragNodeKeys.some(function (d) {\n        return shallowEqual(d, nodeData[valueKey]);\n      })) {\n        return;\n      }\n\n      if (_this.dragNode && shallowEqual(nodeData[valueKey], dragOverNodeKey)) {\n        var lastDropNodePosition = calDropNodePosition(event, _this.nodeRefs[nodeData.refKey]);\n        if (lastDropNodePosition === dropNodePosition) return;\n\n        _this.setState({\n          dropNodePosition: lastDropNodePosition\n        });\n      }\n\n      onDragOver === null || onDragOver === void 0 ? void 0 : onDragOver(nodeData, event);\n    };\n\n    _this.handleDragLeave = function (nodeData, event) {\n      var onDragLeave = _this.props.onDragLeave;\n      onDragLeave === null || onDragLeave === void 0 ? void 0 : onDragLeave(nodeData, event);\n    };\n\n    _this.handleDragEnd = function (nodeData, event) {\n      var onDragEnd = _this.props.onDragEnd;\n\n      _this.setState({\n        dragging: false,\n        dragNodeKeys: [],\n        dragOverNodeKey: null\n      });\n\n      onDragEnd === null || onDragEnd === void 0 ? void 0 : onDragEnd(nodeData, event);\n    };\n\n    _this.handleDrop = function (nodeData, event) {\n      var dragNodeKeys = _this.state.dragNodeKeys;\n      var _this$props11 = _this.props,\n          valueKey = _this$props11.valueKey,\n          onDrop = _this$props11.onDrop;\n\n      if (dragNodeKeys.some(function (d) {\n        return shallowEqual(d, nodeData[valueKey]);\n      })) {\n        console.error('Cannot drag a node to itself and its children');\n      } else {\n        var dropData = _this.getDropData(nodeData);\n\n        onDrop === null || onDrop === void 0 ? void 0 : onDrop(dropData, event);\n      }\n\n      _this.setState({\n        dragging: false,\n        dragNodeKeys: [],\n        dragOverNodeKey: null,\n        dropNodePosition: null\n      });\n\n      _this.dragNode = null;\n    };\n\n    _this.measureRowRenderer = function (nodes) {\n      return function (_ref) {\n        var key = _ref.key,\n            index = _ref.index,\n            style = _ref.style,\n            parent = _ref.parent;\n        var node = nodes[index];\n        return React.createElement(CellMeasurer, {\n          cache: _this.cache,\n          columnIndex: 0,\n          key: key,\n          rowIndex: index,\n          parent: parent\n        }, function () {\n          return _this.renderVirtualNode(node, {\n            key: key,\n            style: style\n          });\n        });\n      };\n    };\n\n    var _value = props.value,\n        data = props.data,\n        _valueKey = props.valueKey,\n        _props$searchKeyword = props.searchKeyword,\n        _searchKeyword = _props$searchKeyword === void 0 ? '' : _props$searchKeyword;\n\n    var nextData = [].concat(data);\n\n    var _nextExpandItemValues = getExpandItemValues(props);\n\n    _this.flattenNodes(nextData);\n\n    _this.unserializeLists('expand', _nextExpandItemValues, props);\n\n    _this.state = {\n      data: data,\n      value: _value,\n      dragging: false,\n      selectedValue: _this.getValue(props),\n      expandAll: getExpandAll(props),\n      filterData: _this.getFilterData(nextData, _searchKeyword, props),\n      activeNode: _this.getActiveNode(_this.getValue(props), _valueKey),\n      searchKeyword: _searchKeyword,\n      expandItemValues: _this.serializeList('expand'),\n      dragNodeKeys: [],\n      dragOverNodeKey: null,\n      dropNodePosition: null\n    };\n    _this.treeViewRef = React.createRef();\n    _this.positionRef = React.createRef();\n    _this.listRef = React.createRef();\n    _this.triggerRef = React.createRef();\n    _this.toggleRef = React.createRef(); // for test\n\n    _this.menuRef = React.createRef();\n    treeDeprecatedWarning(props, ['expandAll']);\n    return _this;\n  }\n\n  var _proto = TreePicker.prototype;\n\n  _proto.componentDidMount = function componentDidMount() {\n    var activeNode = this.state.activeNode;\n    this.focusNode(activeNode);\n  };\n\n  TreePicker.getDerivedStateFromProps = function getDerivedStateFromProps(nextProps, prevState) {\n    var value = nextProps.value,\n        data = nextProps.data,\n        expandAll = nextProps.expandAll,\n        searchKeyword = nextProps.searchKeyword,\n        expandItemValues = nextProps.expandItemValues;\n    var nextState = {};\n\n    if (_isArray(data) && _isArray(prevState.data) && prevState.data !== data) {\n      nextState.data = data;\n    }\n\n    if (!shallowEqual(value, prevState.value)) {\n      nextState.value = value;\n      nextState.selectedValue = value;\n    }\n\n    if (compareArray(expandItemValues, prevState.expandItemValues) && Array.isArray(expandItemValues)) {\n      nextState.expandItemValues = expandItemValues;\n    }\n\n    if (!_isUndefined(searchKeyword) && searchKeyword !== prevState.searchKeyword) {\n      nextState.searchKeyword = searchKeyword;\n    }\n\n    if (expandAll !== prevState.expandAll) {\n      nextState.expandAll = expandAll;\n    }\n\n    return Object.keys(nextState).length ? nextState : null;\n  };\n\n  _proto.componentDidUpdate = function componentDidUpdate(_prevProps, prevState) {\n    this.updateDataChange(prevState);\n    this.updateValueChange(prevState);\n    this.updateExpandItemValuesChange(prevState);\n    this.updateSearchKeywordChange(prevState);\n\n    if (this.listRef.current) {\n      this.listRef.current.forceUpdateGrid();\n    }\n  };\n\n  _proto.updateDataChange = function updateDataChange(prevState) {\n    var _this$state4 = this.state,\n        searchKeyword = _this$state4.searchKeyword,\n        expandItemValues = _this$state4.expandItemValues;\n    var data = this.props.data;\n\n    if (prevState.data !== data) {\n      var nextData = [].concat(data);\n      this.flattenNodes(nextData);\n      var filterData = this.getFilterData(nextData, searchKeyword);\n      var activeNode = this.getActiveNode(this.getValue());\n      this.focusNode(activeNode);\n      this.unserializeLists('expand', expandItemValues);\n      var newState = {};\n\n      if (activeNode) {\n        newState = {\n          activeNode: activeNode\n        };\n      }\n\n      this.setState(_extends({}, {\n        data: nextData,\n        filterData: filterData,\n        expandItemValues: this.serializeList('expand')\n      }, {}, newState));\n    }\n  };\n\n  _proto.updateValueChange = function updateValueChange(prevState) {\n    var _this$props12 = this.props,\n        value = _this$props12.value,\n        valueKey = _this$props12.valueKey;\n\n    if (!shallowEqual(prevState.value, value)) {\n      var activeNode = null;\n\n      if (this.node === null) {\n        activeNode = this.getActiveNode(value);\n      }\n\n      if (value !== null && this.node !== null) {\n        activeNode = shallowEqual(this.node[valueKey], value) ? this.node : this.getActiveNode(value);\n      }\n\n      var nextState = {\n        value: value,\n        activeNode: activeNode\n      };\n\n      if (value === null) {\n        nextState.activeNode = null;\n        this.node = null;\n      }\n\n      if (activeNode !== null) {\n        this.focusNode(activeNode);\n      }\n\n      this.setState(nextState);\n    }\n  };\n\n  _proto.updateExpandItemValuesChange = function updateExpandItemValuesChange(prevState) {\n    var expandItemValues = this.props.expandItemValues;\n\n    if (compareArray(expandItemValues, prevState.expandItemValues) && Array.isArray(expandItemValues)) {\n      this.unserializeLists('expand', expandItemValues);\n      this.setState({\n        expandItemValues: expandItemValues\n      });\n    }\n  };\n\n  _proto.updateSearchKeywordChange = function updateSearchKeywordChange(prevState) {\n    var filterData = this.state.filterData;\n\n    if (!_isUndefined(this.props.searchKeyword) && prevState.searchKeyword !== this.props.searchKeyword) {\n      this.setState({\n        filterData: this.getFilterData(filterData, this.props.searchKeyword)\n      });\n    }\n  };\n\n  _proto.getValue = function getValue(props) {\n    if (props === void 0) {\n      props = this.props;\n    }\n\n    var _props = props,\n        value = _props.value,\n        defaultValue = _props.defaultValue;\n    return !_isUndefined(value) ? value : defaultValue;\n  };\n\n  _proto.getActiveNode = function getActiveNode(value, valueKey) {\n    var _this4 = this;\n\n    if (valueKey === void 0) {\n      valueKey = this.props.valueKey;\n    }\n\n    var activeNode = null;\n\n    if (!_isUndefined(value)) {\n      Object.keys(this.nodes).forEach(function (refKey) {\n        if (shallowEqual(_this4.nodes[refKey][valueKey], value)) {\n          activeNode = _this4.nodes[refKey];\n        }\n      });\n    }\n\n    return activeNode;\n  };\n\n  _proto.getActiveElementOption = function getActiveElementOption(options, value) {\n    var childrenKey = this.props.childrenKey;\n\n    for (var i = 0; i < options.length; i += 1) {\n      var _options$i$childrenKe;\n\n      if (options[i].value === value) {\n        return options[i];\n      } else if ((_options$i$childrenKe = options[i][childrenKey]) === null || _options$i$childrenKe === void 0 ? void 0 : _options$i$childrenKe.length) {\n        var active = this.getActiveElementOption(options[i][childrenKey], value);\n\n        if (!_isEmpty(active)) {\n          return active;\n        }\n      }\n    }\n\n    return {};\n  };\n\n  _proto.getItemsAndActiveIndex = function getItemsAndActiveIndex() {\n    var items = this.getFocusableMenuItems();\n    var activeIndex = -1;\n    items.forEach(function (item, index) {\n      if (document.activeElement !== null) {\n        if (item.refKey === document.activeElement.getAttribute('data-key')) {\n          activeIndex = index;\n        }\n      }\n    });\n    return {\n      items: items,\n      activeIndex: activeIndex\n    };\n  };\n\n  _proto.getActiveItem = function getActiveItem() {\n    var nodeData = {};\n    var activeItem = document.activeElement;\n\n    if (activeItem !== null) {\n      var _get2 = _get(activeItem, 'dataset'),\n          key = _get2.key,\n          layer = _get2.layer;\n\n      var activeNode = this.nodes[key];\n\n      if (activeNode) {\n        nodeData = activeNode;\n      }\n\n      return {\n        nodeData: nodeData,\n        layer: layer\n      };\n    }\n\n    return {};\n  };\n\n  _proto.getFilterData = function getFilterData(data, word, props) {\n    if (word === void 0) {\n      word = '';\n    }\n\n    var _ref2 = props || this.props,\n        labelKey = _ref2.labelKey,\n        childrenKey = _ref2.childrenKey,\n        searchBy = _ref2.searchBy;\n\n    var setVisible = function setVisible(nodes) {\n      if (nodes === void 0) {\n        nodes = [];\n      }\n\n      return nodes.forEach(function (item) {\n        item.visible = searchBy ? searchBy(word, item[labelKey], item) : shouldDisplay(item[labelKey], word);\n\n        if (_isArray(item[childrenKey])) {\n          setVisible(item[childrenKey]);\n          item[childrenKey].forEach(function (child) {\n            if (child.visible) {\n              item.visible = child.visible;\n            }\n          });\n        }\n      });\n    };\n\n    if (!_isUndefined(word)) {\n      setVisible(data);\n    }\n\n    return data;\n  };\n\n  _proto.getFlattenTreeData = function getFlattenTreeData(nodes) {\n    var _this5 = this;\n\n    var expandItemValues = this.state.expandItemValues;\n    var _this$props13 = this.props,\n        childrenKey = _this$props13.childrenKey,\n        valueKey = _this$props13.valueKey;\n    return flattenTree(nodes, childrenKey, function (node) {\n      var formatted = {};\n      var curNode = _this5.nodes[node.refKey];\n      var parentKeys = getNodeParents(curNode, 'parentNode', valueKey);\n\n      if (curNode) {\n        formatted = _extends({}, node, {\n          expand: curNode.expand,\n          layer: curNode.layer,\n          parentNode: curNode.parentNode,\n          showNode: shouldShowNodeByExpanded(expandItemValues, parentKeys)\n        });\n      }\n\n      return formatted;\n    });\n  };\n\n  _proto.getTreeNodeProps = function getTreeNodeProps(node, layer, index) {\n    var _this$state5 = this.state,\n        dragOverNodeKey = _this$state5.dragOverNodeKey,\n        selectedValue = _this$state5.selectedValue,\n        dropNodePosition = _this$state5.dropNodePosition;\n    var dragNode = this.dragNode || {};\n    var _this$props14 = this.props,\n        locale = _this$props14.locale,\n        valueKey = _this$props14.valueKey,\n        labelKey = _this$props14.labelKey,\n        draggable = _this$props14.draggable,\n        childrenKey = _this$props14.childrenKey,\n        _this$props14$disable = _this$props14.disabledItemValues,\n        disabledItemValues = _this$props14$disable === void 0 ? [] : _this$props14$disable,\n        renderTreeNode = _this$props14.renderTreeNode,\n        renderTreeIcon = _this$props14.renderTreeIcon;\n    return {\n      rtl: locale.rtl,\n      value: node[valueKey],\n      label: node[labelKey],\n      index: index,\n      layer: layer,\n      expand: node.expand,\n      active: shallowEqual(node[valueKey], selectedValue),\n      visible: node.visible,\n      draggable: draggable,\n      dragging: shallowEqual(node[valueKey], dragNode[valueKey]),\n      children: node[childrenKey],\n      nodeData: node,\n      disabled: disabledItemValues.some(function (disabledItem) {\n        return shallowEqual(disabledItem, node[valueKey]);\n      }),\n      dragOver: shallowEqual(node[valueKey], dragOverNodeKey) && dropNodePosition === TREE_NODE_DROP_POSITION.DRAG_OVER,\n      dragOverTop: shallowEqual(node[valueKey], dragOverNodeKey) && dropNodePosition === TREE_NODE_DROP_POSITION.DRAG_OVER_TOP,\n      dragOverBottom: shallowEqual(node[valueKey], dragOverNodeKey) && dropNodePosition === TREE_NODE_DROP_POSITION.DRAG_OVER_BOTTOM,\n      onSelect: this.handleSelect,\n      onDragStart: this.handleDragStart,\n      onDragEnter: this.handleDragEnter,\n      onDragOver: this.handleDragOver,\n      onDragLeave: this.handleDragLeave,\n      onDragEnd: this.handleDragEnd,\n      onDrop: this.handleDrop,\n      onTreeToggle: this.handleToggle,\n      onRenderTreeNode: renderTreeNode,\n      onRenderTreeIcon: renderTreeIcon\n    };\n  }\n  /**\n   * 获取 onDrop 的回调数据\n   */\n  ;\n\n  _proto.getDropData = function getDropData(nodeData) {\n    var dropNodePosition = this.state.dropNodePosition;\n    var _this$props15 = this.props,\n        valueKey = _this$props15.valueKey,\n        childrenKey = _this$props15.childrenKey;\n    var options = {\n      valueKey: valueKey,\n      childrenKey: childrenKey\n    };\n\n    var dragNode = _omit(this.dragNode, 'parentNode');\n\n    return {\n      /** 拖拽节点 */\n      dragNode: dragNode,\n\n      /** 释放所在节点的父节点 */\n      dropNode: nodeData,\n\n      /** 拖拽节点的类型 */\n      dropNodePosition: dropNodePosition,\n      createUpdateDataFunction: createUpdateTreeDataFunction({\n        /** 拖拽节点 */\n        dragNode: dragNode,\n\n        /** 释放所在节点的父节点 */\n        dropNode: nodeData,\n\n        /** 拖拽节点的类型 */\n        dropNodePosition: dropNodePosition\n      }, options)\n    };\n  };\n\n  _proto.focusNode = function focusNode(activeNode) {\n    var inline = this.props.inline;\n\n    if (activeNode && inline) {\n      var _node$focus4;\n\n      var node = this.getElementByDataKey(activeNode.refKey);\n      node === null || node === void 0 ? void 0 : (_node$focus4 = node.focus) === null || _node$focus4 === void 0 ? void 0 : _node$focus4.call(node);\n    }\n  };\n\n  _proto.flattenNodes = function flattenNodes(nodes, props, ref, parentNode, layer) {\n    var _this6 = this;\n\n    if (ref === void 0) {\n      ref = '0';\n    }\n\n    if (layer === void 0) {\n      layer = 0;\n    }\n\n    var _ref3 = props || this.props,\n        labelKey = _ref3.labelKey,\n        valueKey = _ref3.valueKey,\n        childrenKey = _ref3.childrenKey;\n\n    if (!Array.isArray(nodes) || nodes.length === 0) {\n      return [];\n    }\n\n    nodes.map(function (node, index) {\n      var _extends2;\n\n      var refKey = ref + \"-\" + index;\n      node.refKey = refKey;\n      _this6.nodes[refKey] = _extends((_extends2 = {\n        layer: layer\n      }, _extends2[labelKey] = node[labelKey], _extends2[valueKey] = node[valueKey], _extends2.expand = getExpandState(node, props || _this6.props), _extends2.refKey = refKey, _extends2), node);\n\n      if (parentNode) {\n        _this6.nodes[refKey].parentNode = parentNode;\n      }\n\n      _this6.flattenNodes(node[childrenKey], props, refKey, _this6.nodes[refKey], layer + 1);\n    });\n  };\n\n  _proto.serializeList = function serializeList(key, nodes) {\n    if (nodes === void 0) {\n      nodes = this.nodes;\n    }\n\n    var valueKey = this.props.valueKey;\n    var list = [];\n    Object.keys(nodes).forEach(function (refKey) {\n      if (nodes[refKey][key]) {\n        list.push(nodes[refKey][valueKey]);\n      }\n    });\n    return list;\n  };\n\n  _proto.unserializeLists = function unserializeLists(key, value, props) {\n    var _this7 = this;\n\n    if (value === void 0) {\n      value = [];\n    }\n\n    if (props === void 0) {\n      props = this.props;\n    }\n\n    var _props2 = props,\n        valueKey = _props2.valueKey;\n    var expandAll = getExpandAll(props);\n    Object.keys(this.nodes).forEach(function (refKey) {\n      _this7.nodes[refKey][key] = false;\n\n      if (value.length) {\n        value.forEach(function (value) {\n          if (shallowEqual(_this7.nodes[refKey][valueKey], value)) {\n            _this7.nodes[refKey][key] = true;\n          }\n        });\n      } else {\n        _this7.nodes[refKey][key] = expandAll;\n      }\n    });\n  };\n\n  _proto.toggleExpand = function toggleExpand(node, isExpand) {\n    var valueKey = this.props.valueKey;\n    var expandItemValues = new Set(this.serializeList('expand'));\n\n    if (isExpand) {\n      expandItemValues.add(node[valueKey]);\n    } else {\n      expandItemValues.delete(node[valueKey]);\n    }\n\n    return Array.from(expandItemValues);\n  };\n\n  _proto.renderDropdownMenu = function renderDropdownMenu() {\n    var _this$props16 = this.props,\n        searchable = _this$props16.searchable,\n        searchKeyword = _this$props16.searchKeyword,\n        renderExtraFooter = _this$props16.renderExtraFooter,\n        locale = _this$props16.locale,\n        renderMenu = _this$props16.renderMenu,\n        menuStyle = _this$props16.menuStyle,\n        menuClassName = _this$props16.menuClassName,\n        menuAutoWidth = _this$props16.menuAutoWidth;\n    var keyword = !_isUndefined(searchKeyword) ? searchKeyword : this.state.searchKeyword;\n    var classes = classNames(menuClassName, this.addPrefix('tree-menu'));\n    return React.createElement(MenuWrapper, {\n      autoWidth: menuAutoWidth,\n      className: classes,\n      style: menuStyle,\n      ref: this.menuRef,\n      getToggleInstance: this.getToggleInstance,\n      getPositionInstance: this.getPositionInstance\n    }, searchable ? React.createElement(SearchBar, {\n      placeholder: locale.searchPlaceholder,\n      key: \"searchBar\",\n      onChange: this.handleSearch,\n      value: keyword\n    }) : null, renderMenu ? renderMenu(this.renderTree()) : this.renderTree(), renderExtraFooter === null || renderExtraFooter === void 0 ? void 0 : renderExtraFooter());\n  };\n\n  _proto.renderNode = function renderNode(node, index, layer) {\n    var _this8 = this;\n\n    var searchKeyword = this.state.searchKeyword;\n    var _this$props17 = this.props,\n        valueKey = _this$props17.valueKey,\n        childrenKey = _this$props17.childrenKey;\n\n    if (!node.visible) {\n      return null;\n    }\n\n    var refKey = node.refKey;\n    var expand = getExpandWhenSearching(searchKeyword, this.nodes[refKey].expand);\n    var key = _isString(node[valueKey]) || _isNumber(node[valueKey]) ? node[valueKey] : refKey;\n    var children = node[childrenKey]; // 当用户进行搜索时，hasChildren的判断要变成判断是否存在 visible 为 true 的子节点\n\n    var visibleChildren = _isUndefined(searchKeyword) || searchKeyword.length === 0 ? !!children : hasVisibleChildren(node, childrenKey);\n\n    var nodeProps = _extends({}, this.getTreeNodeProps(_extends({}, node, {\n      expand: expand\n    }), layer, index), {\n      hasChildren: visibleChildren\n    });\n\n    if (nodeProps.hasChildren) {\n      var _classNames;\n\n      layer += 1; // 是否展开树节点且子节点不为空\n\n      var openClass = this.addTreePrefix('open');\n      var childrenClass = classNames(this.addTreePrefix('node-children'), (_classNames = {}, _classNames[openClass] = expand && visibleChildren, _classNames));\n      var nodes = children || [];\n      return React.createElement(\"div\", {\n        className: childrenClass,\n        key: key\n      }, React.createElement(TreeNode, _extends({}, nodeProps, {\n        innerRef: this.bindNodeRefs.bind(this, refKey)\n      })), React.createElement(\"div\", {\n        className: this.addTreePrefix('children')\n      }, nodes.map(function (child, i) {\n        return _this8.renderNode(child, i, layer);\n      })));\n    }\n\n    return React.createElement(TreeNode, _extends({\n      key: key,\n      innerRef: this.bindNodeRefs.bind(this, refKey)\n    }, nodeProps));\n  };\n\n  _proto.renderVirtualNode = function renderVirtualNode(node, options) {\n    var searchKeyword = this.state.searchKeyword;\n    var childrenKey = this.props.childrenKey;\n    var key = options.key,\n        style = options.style;\n    var layer = node.layer,\n        refKey = node.refKey,\n        showNode = node.showNode;\n    var expand = getExpandWhenSearching(searchKeyword, this.nodes[refKey].expand);\n\n    if (!node.visible) {\n      return null;\n    }\n\n    var nodeProps = _extends({}, this.getTreeNodeProps(_extends({}, node, {\n      expand: expand\n    }), layer), {\n      style: style,\n      hasChildren: !!node[childrenKey]\n    });\n\n    return showNode && React.createElement(TreeNode, _extends({\n      key: key,\n      innerRef: this.bindNodeRefs.bind(this, refKey)\n    }, nodeProps));\n  };\n\n  _proto.renderTree = function renderTree() {\n    var _classNames2,\n        _this9 = this;\n\n    var filterData = this.state.filterData;\n    var _this$props18 = this.props,\n        height = _this$props18.height,\n        className = _this$props18.className,\n        inline = _this$props18.inline,\n        style = _this$props18.style,\n        locale = _this$props18.locale,\n        virtualized = _this$props18.virtualized;\n    var layer = 0;\n    var classes = classNames(defaultClassPrefix('tree'), (_classNames2 = {}, _classNames2[className] = inline, _classNames2));\n    var nodes = [];\n\n    if (!virtualized) {\n      nodes = filterData.map(function (dataItem, index) {\n        return _this9.renderNode(dataItem, index, layer);\n      });\n\n      if (!nodes.some(function (v) {\n        return v !== null;\n      })) {\n        return React.createElement(\"div\", {\n          className: this.addPrefix('none')\n        }, locale.noResultsText);\n      }\n    } else {\n      nodes = this.getFlattenTreeData(filterData).filter(function (n) {\n        return n.showNode && n.visible;\n      });\n\n      if (!nodes.length) {\n        return React.createElement(\"div\", {\n          className: this.addPrefix('none')\n        }, locale.noResultsText);\n      }\n    } // The height of virtualized tree should be subtract the value of paddingBottom\n\n\n    var treeHeight = height - 12;\n    var treeWidth = _isUndefined(style === null || style === void 0 ? void 0 : style.width) ? defaultWidth : style.width;\n    var listStyles = inline ? _extends({\n      height: height\n    }, style) : style;\n    return React.createElement(React.Fragment, null, React.createElement(\"div\", {\n      ref: this.treeViewRef,\n      className: classes,\n      style: listStyles,\n      onKeyDown: this.handleKeyDown\n    }, React.createElement(\"div\", {\n      className: this.addTreePrefix('nodes')\n    }, virtualized ? React.createElement(AutoSizer, {\n      defaultHeight: treeHeight,\n      defaultWidth: treeWidth,\n      style: {\n        width: 'auto',\n        height: 'auto'\n      }\n    }, function (_ref4) {\n      var height = _ref4.height,\n          width = _ref4.width;\n      return React.createElement(List, {\n        ref: _this9.listRef,\n        width: width || treeWidth,\n        height: height,\n        rowHeight: 36,\n        rowCount: nodes.length,\n        rowRenderer: _this9.measureRowRenderer(nodes)\n      });\n    }) : nodes)), this.renderDragNode());\n  };\n\n  _proto.renderDragNode = function renderDragNode() {\n    var _this$props19 = this.props,\n        labelKey = _this$props19.labelKey,\n        draggable = _this$props19.draggable,\n        renderDragNode = _this$props19.renderDragNode;\n    var dragNode = this.dragNode || {};\n\n    if (draggable) {\n      var dragNodeContent = dragNode[labelKey];\n\n      if (_isFunction(renderDragNode)) {\n        dragNodeContent = renderDragNode(dragNode);\n      }\n\n      return React.createElement(\"span\", {\n        id: \"drag-node\",\n        className: this.addTreePrefix('drag-node-mover')\n      }, dragNodeContent);\n    }\n\n    return null;\n  };\n\n  _proto.render = function render() {\n    var _this$props20 = this.props,\n        inline = _this$props20.inline,\n        locale = _this$props20.locale,\n        disabled = _this$props20.disabled,\n        toggleComponentClass = _this$props20.toggleComponentClass,\n        placeholder = _this$props20.placeholder,\n        cleanable = _this$props20.cleanable,\n        renderValue = _this$props20.renderValue,\n        labelKey = _this$props20.labelKey,\n        onEntered = _this$props20.onEntered,\n        onExited = _this$props20.onExited,\n        onClean = _this$props20.onClean,\n        style = _this$props20.style,\n        positionRef = _this$props20.positionRef,\n        rest = _objectWithoutPropertiesLoose(_this$props20, [\"inline\", \"locale\", \"disabled\", \"toggleComponentClass\", \"placeholder\", \"cleanable\", \"renderValue\", \"labelKey\", \"onEntered\", \"onExited\", \"onClean\", \"style\", \"positionRef\"]);\n\n    var _this$state6 = this.state,\n        selectedValue = _this$state6.selectedValue,\n        activeNode = _this$state6.activeNode;\n\n    var hasValidValue = !_isNil(activeNode) || !_isNil(selectedValue) && _isFunction(renderValue);\n\n    var selectedElement = placeholder;\n    var hasValue = !!activeNode;\n    /**\n     * if value is invalid and renderValue is undefined, then using placeholder.\n     * if value is valid and renderValue is't undefined, then using renderValue()\n     */\n\n    if (!_isNil(selectedValue)) {\n      if (hasValue) {\n        selectedElement = activeNode[labelKey];\n      }\n\n      if (_isFunction(renderValue)) {\n        var node = activeNode !== null && activeNode !== void 0 ? activeNode : {};\n        selectedElement = renderValue(selectedValue, node, selectedElement);\n\n        if (_isNil(selectedElement)) {\n          hasValidValue = false;\n        }\n      }\n    }\n\n    var unhandled = getUnhandledProps(TreePicker, rest);\n    var classes = getToggleWrapperClassName('tree', this.addPrefix, this.props, hasValidValue);\n\n    if (inline) {\n      return this.renderTree();\n    }\n\n    return React.createElement(PickerToggleTrigger, {\n      pickerProps: this.props,\n      ref: this.triggerRef,\n      positionRef: mergeRefs(this.positionRef, positionRef),\n      onEntered: createChainedFunction(this.handleOnOpen, onEntered),\n      onExited: createChainedFunction(this.handleOnClose, onExited),\n      speaker: this.renderDropdownMenu()\n    }, React.createElement(\"div\", {\n      className: classes,\n      style: style\n    }, React.createElement(PickerToggle, _extends({}, unhandled, {\n      ref: this.toggleRef,\n      onKeyDown: this.handleToggleKeyDown,\n      onClean: createChainedFunction(this.handleClean, onClean),\n      cleanable: cleanable && !disabled,\n      componentClass: toggleComponentClass,\n      hasValue: hasValidValue,\n      active: this.state.active,\n      \"aria-disabled\": disabled\n    }), selectedElement || locale.placeholder)));\n  };\n\n  return TreePicker;\n}(React.Component);\n\nTreePicker.propTypes = _extends({}, listPickerPropTypes, {\n  height: PropTypes.number,\n  inline: PropTypes.bool,\n  draggable: PropTypes.bool,\n  expandAll: PropTypes.bool,\n  virtualized: PropTypes.bool,\n  searchable: PropTypes.bool,\n  menuAutoWidth: PropTypes.bool,\n  searchKeyword: PropTypes.string,\n  defaultExpandAll: PropTypes.bool,\n  expandItemValues: PropTypes.array,\n  defaultExpandItemValues: PropTypes.array,\n  onSearch: PropTypes.func,\n  onExpand: PropTypes.func,\n  onSelect: PropTypes.func,\n  renderMenu: PropTypes.func,\n  renderTreeNode: PropTypes.func,\n  renderTreeIcon: PropTypes.func,\n  renderExtraFooter: PropTypes.func,\n  renderDragNode: PropTypes.func,\n  searchBy: PropTypes.func\n});\nTreePicker.defaultProps = _extends({}, listPickerDefaultProps, {\n  height: defaultHeight,\n  searchable: true,\n  menuAutoWidth: true,\n  locale: {\n    placeholder: 'Select',\n    searchPlaceholder: 'Search',\n    noResultsText: 'No results found'\n  }\n});\npolyfill(TreePicker);\nexport default defaultProps({\n  classPrefix: 'picker'\n})(TreePicker);"],"mappings":"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"},"metadata":{},"sourceType":"module"}